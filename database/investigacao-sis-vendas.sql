-- ============================================================================
-- INVESTIGAÇÃO: SIS_VENDAS (PDV - Ponto de Venda)
-- ============================================================================
-- Objetivo: Mapear schemas, tabelas e estrutura do PDV
-- Data: 17/01/2026
-- Status: PARA INCLUSÃO FUTURA
-- ============================================================================

-- ============================================================================
-- ETAPA 1: LISTAR TODOS OS SCHEMAS
-- ============================================================================
SELECT 
    schema_name,
    schema_owner,
    CASE 
        WHEN schema_name IN ('pg_catalog', 'information_schema') THEN 'Sistema'
        ELSE 'Aplicação'
    END as tipo
FROM information_schema.schemata
WHERE schema_name NOT IN ('pg_toast', 'pg_temp_1', 'pg_toast_temp_1')
ORDER BY 
    CASE WHEN schema_name = 'public' THEN 1 ELSE 2 END,
    schema_name;


| schema_name        | schema_owner      | tipo      |
| ------------------ | ----------------- | --------- |
| public             | pg_database_owner | Aplicação |
| auditoria          | postgres          | Aplicação |
| auth               | supabase_admin    | Aplicação |
| auth_sistema       | postgres          | Aplicação |
| carnes             | postgres          | Aplicação |
| core               | postgres          | Aplicação |
| cron               | supabase_admin    | Aplicação |
| descontos          | postgres          | Aplicação |
| extensions         | postgres          | Aplicação |
| fechamento_caixa   | postgres          | Aplicação |
| graphql            | supabase_admin    | Aplicação |
| graphql_public     | supabase_admin    | Aplicação |
| information_schema | supabase_admin    | Sistema   |
| marketing          | postgres          | Aplicação |
| net                | supabase_admin    | Aplicação |
| pagamentos         | postgres          | Aplicação |
| pg_catalog         | supabase_admin    | Sistema   |
| pg_temp_0          | supabase_admin    | Aplicação |
| pg_temp_10         | supabase_admin    | Aplicação |
| pg_temp_11         | supabase_admin    | Aplicação |
| pg_temp_12         | supabase_admin    | Aplicação |
| pg_temp_13         | supabase_admin    | Aplicação |
| pg_temp_14         | supabase_admin    | Aplicação |
| pg_temp_15         | supabase_admin    | Aplicação |
| pg_temp_16         | supabase_admin    | Aplicação |
| pg_temp_17         | supabase_admin    | Aplicação |
| pg_temp_18         | supabase_admin    | Aplicação |
| pg_temp_19         | supabase_admin    | Aplicação |
| pg_temp_2          | supabase_admin    | Aplicação |
| pg_temp_20         | supabase_admin    | Aplicação |
| pg_temp_21         | supabase_admin    | Aplicação |
| pg_temp_22         | supabase_admin    | Aplicação |
| pg_temp_23         | supabase_admin    | Aplicação |
| pg_temp_24         | supabase_admin    | Aplicação |
| pg_temp_25         | supabase_admin    | Aplicação |
| pg_temp_26         | supabase_admin    | Aplicação |
| pg_temp_27         | supabase_admin    | Aplicação |
| pg_temp_28         | supabase_admin    | Aplicação |
| pg_temp_29         | supabase_admin    | Aplicação |
| pg_temp_3          | supabase_admin    | Aplicação |
| pg_temp_30         | supabase_admin    | Aplicação |
| pg_temp_31         | supabase_admin    | Aplicação |
| pg_temp_32         | supabase_admin    | Aplicação |
| pg_temp_33         | supabase_admin    | Aplicação |
| pg_temp_34         | supabase_admin    | Aplicação |
| pg_temp_35         | supabase_admin    | Aplicação |
| pg_temp_36         | supabase_admin    | Aplicação |
| pg_temp_37         | supabase_admin    | Aplicação |
| pg_temp_38         | supabase_admin    | Aplicação |
| pg_temp_39         | supabase_admin    | Aplicação |
| pg_temp_4          | supabase_admin    | Aplicação |
| pg_temp_40         | supabase_admin    | Aplicação |
| pg_temp_41         | supabase_admin    | Aplicação |
| pg_temp_42         | supabase_admin    | Aplicação |
| pg_temp_43         | supabase_admin    | Aplicação |
| pg_temp_44         | supabase_admin    | Aplicação |
| pg_temp_45         | supabase_admin    | Aplicação |
| pg_temp_46         | supabase_admin    | Aplicação |
| pg_temp_47         | supabase_admin    | Aplicação |
| pg_temp_48         | supabase_admin    | Aplicação |
| pg_temp_49         | supabase_admin    | Aplicação |
| pg_temp_5          | supabase_admin    | Aplicação |
| pg_temp_50         | supabase_admin    | Aplicação |
| pg_temp_51         | supabase_admin    | Aplicação |
| pg_temp_52         | supabase_admin    | Aplicação |
| pg_temp_53         | supabase_admin    | Aplicação |
| pg_temp_54         | supabase_admin    | Aplicação |
| pg_temp_55         | supabase_admin    | Aplicação |
| pg_temp_56         | supabase_admin    | Aplicação |
| pg_temp_57         | supabase_admin    | Aplicação |
| pg_temp_58         | supabase_admin    | Aplicação |
| pg_temp_59         | supabase_admin    | Aplicação |
| pg_temp_6          | supabase_admin    | Aplicação |
| pg_temp_7          | supabase_admin    | Aplicação |
| pg_temp_8          | supabase_admin    | Aplicação |
| pg_temp_9          | supabase_admin    | Aplicação |
| pg_toast_temp_0    | supabase_admin    | Aplicação |
| pg_toast_temp_10   | supabase_admin    | Aplicação |
| pg_toast_temp_11   | supabase_admin    | Aplicação |
| pg_toast_temp_12   | supabase_admin    | Aplicação |
| pg_toast_temp_13   | supabase_admin    | Aplicação |
| pg_toast_temp_14   | supabase_admin    | Aplicação |
| pg_toast_temp_15   | supabase_admin    | Aplicação |
| pg_toast_temp_16   | supabase_admin    | Aplicação |
| pg_toast_temp_17   | supabase_admin    | Aplicação |
| pg_toast_temp_18   | supabase_admin    | Aplicação |
| pg_toast_temp_19   | supabase_admin    | Aplicação |
| pg_toast_temp_2    | supabase_admin    | Aplicação |
| pg_toast_temp_20   | supabase_admin    | Aplicação |
| pg_toast_temp_21   | supabase_admin    | Aplicação |
| pg_toast_temp_22   | supabase_admin    | Aplicação |
| pg_toast_temp_23   | supabase_admin    | Aplicação |
| pg_toast_temp_24   | supabase_admin    | Aplicação |
| pg_toast_temp_25   | supabase_admin    | Aplicação |
| pg_toast_temp_26   | supabase_admin    | Aplicação |
| pg_toast_temp_27   | supabase_admin    | Aplicação |
| pg_toast_temp_28   | supabase_admin    | Aplicação |
| pg_toast_temp_29   | supabase_admin    | Aplicação |
| pg_toast_temp_3    | supabase_admin    | Aplicação |
| pg_toast_temp_30   | supabase_admin    | Aplicação |
| pg_toast_temp_31   | supabase_admin    | Aplicação |
| pg_toast_temp_32   | supabase_admin    | Aplicação |
| pg_toast_temp_33   | supabase_admin    | Aplicação |
| pg_toast_temp_34   | supabase_admin    | Aplicação |
| pg_toast_temp_35   | supabase_admin    | Aplicação |
| pg_toast_temp_36   | supabase_admin    | Aplicação |
| pg_toast_temp_37   | supabase_admin    | Aplicação |
| pg_toast_temp_38   | supabase_admin    | Aplicação |
| pg_toast_temp_39   | supabase_admin    | Aplicação |
| pg_toast_temp_4    | supabase_admin    | Aplicação |
| pg_toast_temp_40   | supabase_admin    | Aplicação |
| pg_toast_temp_41   | supabase_admin    | Aplicação |
| pg_toast_temp_42   | supabase_admin    | Aplicação |
| pg_toast_temp_43   | supabase_admin    | Aplicação |
| pg_toast_temp_44   | supabase_admin    | Aplicação |
| pg_toast_temp_45   | supabase_admin    | Aplicação |
| pg_toast_temp_46   | supabase_admin    | Aplicação |
| pg_toast_temp_47   | supabase_admin    | Aplicação |
| pg_toast_temp_48   | supabase_admin    | Aplicação |
| pg_toast_temp_49   | supabase_admin    | Aplicação |
| pg_toast_temp_5    | supabase_admin    | Aplicação |
| pg_toast_temp_50   | supabase_admin    | Aplicação |
| pg_toast_temp_51   | supabase_admin    | Aplicação |
| pg_toast_temp_52   | supabase_admin    | Aplicação |
| pg_toast_temp_53   | supabase_admin    | Aplicação |
| pg_toast_temp_54   | supabase_admin    | Aplicação |
| pg_toast_temp_55   | supabase_admin    | Aplicação |
| pg_toast_temp_56   | supabase_admin    | Aplicação |
| pg_toast_temp_57   | supabase_admin    | Aplicação |
| pg_toast_temp_58   | supabase_admin    | Aplicação |
| pg_toast_temp_59   | supabase_admin    | Aplicação |
| pg_toast_temp_6    | supabase_admin    | Aplicação |
| pg_toast_temp_7    | supabase_admin    | Aplicação |
| pg_toast_temp_8    | supabase_admin    | Aplicação |
| pg_toast_temp_9    | supabase_admin    | Aplicação |
| pgbouncer          | pgbouncer         | Aplicação |
| realtime           | supabase_admin    | Aplicação |
| storage            | supabase_admin    | Aplicação |
| supabase_functions | supabase_admin    | Aplicação |
| vault              | supabase_admin    | Aplicação |
| vendas             | postgres          | Aplicação |


-- ============================================================================
-- ETAPA 2: LISTAR TODAS AS TABELAS POR SCHEMA
-- ============================================================================
SELECT 
    table_schema as schema,
    table_name as tabela,
    table_type as tipo,
    (SELECT COUNT(*) 
     FROM information_schema.columns c 
     WHERE c.table_schema = t.table_schema 
     AND c.table_name = t.table_name) as total_colunas
FROM information_schema.tables t
WHERE table_schema NOT IN ('pg_catalog', 'information_schema')
ORDER BY 
    table_schema,
    CASE table_type 
        WHEN 'BASE TABLE' THEN 1
        WHEN 'VIEW' THEN 2
        ELSE 3
    END,
    table_name;

| schema             | tabela                          | tipo       | total_colunas |
| ------------------ | ------------------------------- | ---------- | ------------- |
| auditoria          | acesso_usuarios                 | BASE TABLE | 25            |
| auditoria          | historico_valores               | BASE TABLE | 19            |
| auditoria          | log_alteracoes                  | BASE TABLE | 18            |
| auditoria          | snapshots_diarios               | BASE TABLE | 22            |
| auditoria          | v_ajustes_valores_recentes      | VIEW       | 11            |
| auditoria          | v_alteracoes_por_usuario        | VIEW       | 7             |
| auditoria          | v_login_falhados                | VIEW       | 5             |
| auditoria          | v_resumo_snapshots              | VIEW       | 10            |
| auditoria          | v_ultimas_alteracoes            | VIEW       | 10            |
| auth               | audit_log_entries               | BASE TABLE | 5             |
| auth               | flow_state                      | BASE TABLE | 12            |
| auth               | identities                      | BASE TABLE | 9             |
| auth               | instances                       | BASE TABLE | 5             |
| auth               | mfa_amr_claims                  | BASE TABLE | 5             |
| auth               | mfa_challenges                  | BASE TABLE | 7             |
| auth               | mfa_factors                     | BASE TABLE | 13            |
| auth               | oauth_authorizations            | BASE TABLE | 17            |
| auth               | oauth_client_states             | BASE TABLE | 4             |
| auth               | oauth_clients                   | BASE TABLE | 12            |
| auth               | oauth_consents                  | BASE TABLE | 6             |
| auth               | one_time_tokens                 | BASE TABLE | 7             |
| auth               | refresh_tokens                  | BASE TABLE | 9             |
| auth               | saml_providers                  | BASE TABLE | 9             |
| auth               | saml_relay_states               | BASE TABLE | 8             |
| auth               | schema_migrations               | BASE TABLE | 1             |
| auth               | sessions                        | BASE TABLE | 15            |
| auth               | sso_domains                     | BASE TABLE | 5             |
| auth               | sso_providers                   | BASE TABLE | 5             |
| auth               | users                           | BASE TABLE | 35            |
| auth_sistema       | audit_logs                      | BASE TABLE | 14            |
| auth_sistema       | cargos                          | BASE TABLE | 10            |
| auth_sistema       | permissions                     | BASE TABLE | 9             |
| auth_sistema       | redes                           | BASE TABLE | 20            |
| auth_sistema       | roles                           | BASE TABLE | 12            |
| auth_sistema       | user_lojas                      | BASE TABLE | 10            |
| auth_sistema       | user_permissions                | BASE TABLE | 8             |
| auth_sistema       | user_sessions                   | BASE TABLE | 13            |
| auth_sistema       | users                           | BASE TABLE | 29            |
| carnes             | apis_configuracao               | BASE TABLE | 14            |
| carnes             | apis_uso_log                    | BASE TABLE | 8             |
| carnes             | config_taxas_juros              | BASE TABLE | 23            |
| carnes             | consultas_externas              | BASE TABLE | 35            |
| carnes             | consultas_recentes              | VIEW       | 12            |
| carnes             | dashboard_consultas             | VIEW       | 10            |
| core               | clientes                        | BASE TABLE | 22            |
| core               | contadores_venda                | BASE TABLE | 7             |
| core               | endereco_cliente                | BASE TABLE | 15            |
| core               | lojas                           | BASE TABLE | 25            |
| core               | telefones                       | BASE TABLE | 12            |
| core               | user_roles                      | BASE TABLE | 7             |
| core               | vendedores                      | BASE TABLE | 19            |
| core               | vendedores_backup               | BASE TABLE | 16            |
| core               | vendedores_lojas                | BASE TABLE | 10            |
| core               | v_user_permissions              | VIEW       | 9             |
| core               | vendedores_com_lojas            | VIEW       | 16            |
| cron               | job                             | BASE TABLE | 9             |
| cron               | job_run_details                 | BASE TABLE | 10            |
| descontos          | config_descontos_por_cargo      | BASE TABLE | 20            |
| descontos          | historico_descontos             | BASE TABLE | 24            |
| descontos          | vw_relatorio_descontos          | VIEW       | 21            |
| extensions         | pg_stat_statements              | VIEW       | 49            |
| extensions         | pg_stat_statements_info         | VIEW       | 2             |
| fechamento_caixa   | movimentacoes                   | BASE TABLE | 8             |
| fechamento_caixa   | sessoes                         | BASE TABLE | 21            |
| marketing          | agendamentos                    | BASE TABLE | 20            |
| marketing          | analises_mercado                | BASE TABLE | 16            |
| marketing          | automacoes                      | BASE TABLE | 15            |
| marketing          | campanhas                       | BASE TABLE | 24            |
| marketing          | campanhas_aniversario           | BASE TABLE | 32            |
| marketing          | campanhas_recorrentes           | BASE TABLE | 18            |
| marketing          | canais_aquisicao                | BASE TABLE | 8             |
| marketing          | cliente_info                    | BASE TABLE | 15            |
| marketing          | clientes_canal_origem           | BASE TABLE | 10            |
| marketing          | comunicacoes                    | BASE TABLE | 29            |
| marketing          | conversoes_orcamento            | BASE TABLE | 23            |
| marketing          | cupons_aniversario              | BASE TABLE | 25            |
| marketing          | curadoria_log                   | BASE TABLE | 9             |
| marketing          | envios_campanha_orcamento       | BASE TABLE | 17            |
| marketing          | interacoes                      | BASE TABLE | 16            |
| marketing          | landing_pages                   | BASE TABLE | 20            |
| marketing          | leads                           | BASE TABLE | 30            |
| marketing          | mensagens_enviadas              | BASE TABLE | 14            |
| marketing          | prompts_ia                      | BASE TABLE | 21            |
| marketing          | sugestoes_campanha              | BASE TABLE | 31            |
| marketing          | templates                       | BASE TABLE | 13            |
| marketing          | templates_mensagem              | BASE TABLE | 10            |
| marketing          | tendencias                      | BASE TABLE | 22            |
| marketing          | v_analise_conversoes            | VIEW       | 17            |
| marketing          | v_performance_canais_conversao  | VIEW       | 11            |
| marketing          | view_dashboard_orcamentos       | VIEW       | 12            |
| net                | _http_response                  | BASE TABLE | 8             |
| net                | http_request_queue              | BASE TABLE | 6             |
| pagamentos         | controle_carnes                 | BASE TABLE | 15            |
| pagamentos         | entradas_carne                  | BASE TABLE | 26            |
| pagamentos         | entregas                        | BASE TABLE | 23            |
| pagamentos         | pagamentos_adicionais           | BASE TABLE | 10            |
| pagamentos         | resumo_clientes                 | BASE TABLE | 18            |
| pagamentos         | v_analise_carnes                | VIEW       | 10            |
| pagamentos         | v_entradas_completas            | VIEW       | 12            |
| pagamentos         | v_top_clientes                  | VIEW       | 9             |
| public             | admin_equipe_por_loja           | VIEW       | 12            |
| public             | admin_lojas_completo            | VIEW       | 33            |
| public             | admin_pessoal_completo          | VIEW       | 38            |
| public             | admin_profissionais_saude       | VIEW       | 39            |
| public             | caixa_movimentacoes             | VIEW       | 8             |
| public             | caixa_sessoes                   | VIEW       | 21            |
| public             | canais_aquisicao                | VIEW       | 8             |
| public             | cargos                          | VIEW       | 12            |
| public             | clientes                        | VIEW       | 17            |
| public             | config_descontos_por_cargo      | VIEW       | 20            |
| public             | configuracoes_juros             | VIEW       | 15            |
| public             | contratos_carne                 | VIEW       | 27            |
| public             | endereco_cliente                | VIEW       | 15            |
| public             | formas_pagamento                | VIEW       | 18            |
| public             | formas_pagamento_disponiveis    | VIEW       | 16            |
| public             | itens_venda                     | VIEW       | 39            |
| public             | limites_desconto_por_cargo      | VIEW       | 7             |
| public             | limites_desconto_por_usuario    | VIEW       | 10            |
| public             | lojas_ativas                    | VIEW       | 19            |
| public             | orcamentos                      | VIEW       | 17            |
| public             | parcelas                        | VIEW       | 12            |
| public             | parcelas_com_juros              | VIEW       | 19            |
| public             | profissionais_para_receitas     | VIEW       | 6             |
| public             | profissionais_saude             | VIEW       | 21            |
| public             | receitas                        | VIEW       | 28            |
| public             | responsaveis_oticos             | VIEW       | 27            |
| public             | responsaveis_oticos_ativos      | VIEW       | 22            |
| public             | resumo_dia                      | VIEW       | 14            |
| public             | roles                           | VIEW       | 13            |
| public             | telefones                       | VIEW       | 10            |
| public             | v_audit_logs_recentes           | VIEW       | 19            |
| public             | v_despesas_caixa                | VIEW       | 10            |
| public             | v_entregas_caixa                | VIEW       | 9             |
| public             | v_movimentacoes_caixa           | VIEW       | 7             |
| public             | v_movimentacoes_financeiras_dia | VIEW       | 9             |
| public             | v_pagamentos_adicionais_caixa   | VIEW       | 9             |
| public             | v_pagamentos_carnes_caixa       | VIEW       | 8             |
| public             | v_parcelas_vencidas             | VIEW       | 14            |
| public             | v_timeline_venda                | VIEW       | 14            |
| public             | v_user_lojas_acesso             | VIEW       | 19            |
| public             | v_user_permissions              | VIEW       | 13            |
| public             | v_users_completo                | VIEW       | 32            |
| public             | v_vendas_caixa_dia              | VIEW       | 9             |
| public             | v_vendas_por_status             | VIEW       | 7             |
| public             | vendas                          | VIEW       | 23            |
| public             | vendas_ativas                   | VIEW       | 14            |
| public             | vendas_carne_entrada_pendente   | VIEW       | 15            |
| public             | vendas_detalhes                 | VIEW       | 23            |
| public             | vendas_dia                      | VIEW       | 16            |
| public             | vendas_formas_pagamento         | VIEW       | 12            |
| public             | vendas_itens                    | VIEW       | 8             |
| public             | vendas_saldo_pendente           | VIEW       | 12            |
| public             | vw_clientes                     | VIEW       | 23            |
| public             | vw_dashboard_lojas              | VIEW       | 13            |
| public             | vw_dashboard_stats              | VIEW       | 13            |
| public             | vw_dashboard_ultimas_vendas     | VIEW       | 12            |
| public             | vw_entregas_calendario          | VIEW       | 27            |
| public             | vw_formas_pagamento             | VIEW       | 13            |
| public             | vw_parcelas                     | VIEW       | 14            |
| public             | vw_performance_receitas         | VIEW       | 7             |
| public             | vw_performance_vendedores       | VIEW       | 8             |
| public             | vw_produtos_mais_vendidos       | VIEW       | 7             |
| public             | vw_venda_detalhes               | VIEW       | 22            |
| public             | vw_vendas                       | VIEW       | 32            |
| public             | vw_vendas_geral                 | VIEW       | 32            |
| realtime           | messages                        | BASE TABLE | 8             |
| realtime           | schema_migrations               | BASE TABLE | 2             |
| realtime           | subscription                    | BASE TABLE | 7             |
| storage            | buckets                         | BASE TABLE | 11            |
| storage            | buckets_analytics               | BASE TABLE | 7             |
| storage            | buckets_vectors                 | BASE TABLE | 4             |
| storage            | migrations                      | BASE TABLE | 4             |
| storage            | objects                         | BASE TABLE | 13            |
| storage            | prefixes                        | BASE TABLE | 5             |
| storage            | s3_multipart_uploads            | BASE TABLE | 9             |
| storage            | s3_multipart_uploads_parts      | BASE TABLE | 10            |
| storage            | vector_indexes                  | BASE TABLE | 9             |
| supabase_functions | hooks                           | BASE TABLE | 5             |
| supabase_functions | migrations                      | BASE TABLE | 2             |
| vault              | secrets                         | BASE TABLE | 8             |
| vault              | decrypted_secrets               | VIEW       | 9             |
| vendas             | autorizacoes                    | BASE TABLE | 16            |
| vendas             | backup_numeros_original         | BASE TABLE | 2             |
| vendas             | contratos_carne                 | BASE TABLE | 27            |
| vendas             | despesas_operacionais           | BASE TABLE | 10            |
| vendas             | entregas_brindes                | BASE TABLE | 7             |
| vendas             | entregas_carne                  | BASE TABLE | 11            |
| vendas             | entregas_os                     | BASE TABLE | 8             |
| vendas             | formas_pagamento                | BASE TABLE | 18            |
| vendas             | historico_entrada               | BASE TABLE | 8             |
| vendas             | historico_status                | BASE TABLE | 11            |
| vendas             | itens_orcamento                 | BASE TABLE | 12            |
| vendas             | itens_venda                     | BASE TABLE | 39            |
| vendas             | logs_conversao_carne            | BASE TABLE | 13            |
| vendas             | notificacoes_entrada            | BASE TABLE | 9             |
| vendas             | orcamentos                      | BASE TABLE | 17            |
| vendas             | pagamentos                      | BASE TABLE | 9             |
| vendas             | parcelas                        | BASE TABLE | 18            |
| vendas             | profissionais_saude             | BASE TABLE | 31            |
| vendas             | recebimentos_carne              | BASE TABLE | 15            |
| vendas             | receitas                        | BASE TABLE | 28            |
| vendas             | responsaveis_oticos             | BASE TABLE | 20            |
| vendas             | restantes_entrada               | BASE TABLE | 14            |
| vendas             | restituicoes                    | BASE TABLE | 12            |
| vendas             | vendas                          | BASE TABLE | 51            |
| vendas             | vendas_formas_pagamento         | BASE TABLE | 23            |
| vendas             | v_autorizacoes_monitor          | VIEW       | 15            |
| vendas             | v_carnes_com_status             | VIEW       | 19            |
| vendas             | v_parcelas_com_pagamentos       | VIEW       | 11            |
| vendas             | v_parcelas_vencidas             | VIEW       | 14            |
| vendas             | v_timeline_venda                | VIEW       | 14            |
| vendas             | v_vendas_por_status             | VIEW       | 7             |
| vendas             | vw_vendas_aguardando_entrada    | VIEW       | 16            |


-- ============================================================================
-- ETAPA 3: DESCOBRIR SCHEMA PRINCIPAL DO PDV
-- ============================================================================
-- Procurar schemas relacionados a vendas/PDV
SELECT 
    table_schema as schema,
    COUNT(DISTINCT table_name) as total_tabelas
FROM information_schema.tables
WHERE table_schema NOT IN ('pg_catalog', 'information_schema', 'auth', 'storage', 'realtime', 'vault', 'extensions', 'graphql', 'graphql_public')
AND table_type = 'BASE TABLE'
GROUP BY table_schema
ORDER BY total_tabelas DESC;


| schema             | total_tabelas |
| ------------------ | ------------- |
| vendas             | 25            |
| marketing          | 23            |
| auth_sistema       | 9             |
| core               | 9             |
| pagamentos         | 5             |
| auditoria          | 4             |
| carnes             | 4             |
| fechamento_caixa   | 2             |
| net                | 2             |
| descontos          | 2             |
| supabase_functions | 2             |
| cron               | 2             |

-- ============================================================================
-- ETAPA 4: BUSCAR TABELAS DE VENDAS/PRODUTOS
-- ============================================================================
-- Procurar tabelas com padrões relacionados a vendas
SELECT 
    table_schema,
    table_name,
    table_type
FROM information_schema.tables
WHERE (table_name ILIKE '%venda%' 
    OR table_name ILIKE '%produto%'
    OR table_name ILIKE '%armacao%'
    OR table_name ILIKE '%item%'
    OR table_name ILIKE '%cliente%'
    OR table_name ILIKE '%pedido%')
AND table_schema NOT IN ('pg_catalog', 'information_schema')
ORDER BY table_schema, table_name;


| table_schema | table_name                    | table_type |
| ------------ | ----------------------------- | ---------- |
| core         | clientes                      | BASE TABLE |
| core         | contadores_venda              | BASE TABLE |
| core         | endereco_cliente              | BASE TABLE |
| marketing    | cliente_info                  | BASE TABLE |
| marketing    | clientes_canal_origem         | BASE TABLE |
| pagamentos   | resumo_clientes               | BASE TABLE |
| pagamentos   | v_top_clientes                | VIEW       |
| public       | clientes                      | VIEW       |
| public       | endereco_cliente              | VIEW       |
| public       | itens_venda                   | VIEW       |
| public       | v_timeline_venda              | VIEW       |
| public       | v_vendas_caixa_dia            | VIEW       |
| public       | v_vendas_por_status           | VIEW       |
| public       | vendas                        | VIEW       |
| public       | vendas_ativas                 | VIEW       |
| public       | vendas_carne_entrada_pendente | VIEW       |
| public       | vendas_detalhes               | VIEW       |
| public       | vendas_dia                    | VIEW       |
| public       | vendas_formas_pagamento       | VIEW       |
| public       | vendas_itens                  | VIEW       |
| public       | vendas_saldo_pendente         | VIEW       |
| public       | vw_clientes                   | VIEW       |
| public       | vw_dashboard_ultimas_vendas   | VIEW       |
| public       | vw_produtos_mais_vendidos     | VIEW       |
| public       | vw_venda_detalhes             | VIEW       |
| public       | vw_vendas                     | VIEW       |
| public       | vw_vendas_geral               | VIEW       |
| vendas       | itens_venda                   | BASE TABLE |
| vendas       | v_timeline_venda              | VIEW       |
| vendas       | v_vendas_por_status           | VIEW       |
| vendas       | vendas                        | BASE TABLE |
| vendas       | vendas_formas_pagamento       | BASE TABLE |
| vendas       | vw_vendas_aguardando_entrada  | VIEW       |


-- ============================================================================
-- ETAPA 5: ESTRUTURA DAS TABELAS ENCONTRADAS
-- ============================================================================
-- (Executar para cada tabela encontrada na ETAPA 4)
-- Exemplo genérico - ajustar table_schema e table_name
SELECT 
    column_name as coluna,
    data_type as tipo,
    character_maximum_length as tamanho,
    is_nullable as aceita_null,
    column_default as valor_padrao
FROM information_schema.columns
WHERE table_schema = 'public'  -- ajustar com resultado da ETAPA 3
AND table_name = 'vendas'      -- ajustar com resultado da ETAPA 4
ORDER BY ordinal_position;


| coluna               | tipo                        | tamanho | aceita_null | valor_padrao |
| -------------------- | --------------------------- | ------- | ----------- | ------------ |
| id                   | uuid                        | null    | YES         | null         |
| numero_venda         | character varying           | 50      | YES         | null         |
| cliente_id           | uuid                        | null    | YES         | null         |
| cliente_nome         | character varying           | 200     | YES         | null         |
| cliente_cpf          | character varying           | 14      | YES         | null         |
| loja_id              | uuid                        | null    | YES         | null         |
| loja_nome            | character varying           | 100     | YES         | null         |
| data_venda           | date                        | null    | YES         | null         |
| valor_total          | numeric                     | null    | YES         | null         |
| valor_entrada        | numeric                     | null    | YES         | null         |
| valor_restante       | numeric                     | null    | YES         | null         |
| status               | USER-DEFINED                | null    | YES         | null         |
| observacoes          | text                        | null    | YES         | null         |
| created_by           | character varying           | 100     | YES         | null         |
| vendedor_nome        | character varying           | 200     | YES         | null         |
| status_pos_venda     | USER-DEFINED                | null    | YES         | null         |
| data_confirmacao     | timestamp without time zone | null    | YES         | null         |
| data_inicio_producao | timestamp without time zone | null    | YES         | null         |
| data_produto_pronto  | timestamp without time zone | null    | YES         | null         |
| data_entrega         | timestamp without time zone | null    | YES         | null         |
| created_at           | timestamp without time zone | null    | YES         | null         |
| updated_at           | timestamp without time zone | null    | YES         | null         |
| total_itens          | bigint                      | null    | YES         | null         |


-- ============================================================================
-- ETAPA 6: RELACIONAMENTOS (FOREIGN KEYS)
-- ============================================================================
SELECT
    tc.table_schema as schema_origem,
    tc.table_name as tabela_origem,
    kcu.column_name as coluna_origem,
    ccu.table_schema as schema_destino,
    ccu.table_name as tabela_destino,
    ccu.column_name as coluna_destino,
    tc.constraint_name as nome_constraint
FROM information_schema.table_constraints tc
JOIN information_schema.key_column_usage kcu
    ON tc.constraint_name = kcu.constraint_name
    AND tc.table_schema = kcu.table_schema
JOIN information_schema.constraint_column_usage ccu
    ON ccu.constraint_name = tc.constraint_name
    AND ccu.table_schema = tc.table_schema
WHERE tc.constraint_type = 'FOREIGN KEY'
AND tc.table_schema NOT IN ('pg_catalog', 'information_schema')
ORDER BY tc.table_schema, tc.table_name;


| schema_origem    | tabela_origem             | coluna_origem            | schema_destino   | tabela_destino          | coluna_destino | nome_constraint                                       |
| ---------------- | ------------------------- | ------------------------ | ---------------- | ----------------------- | -------------- | ----------------------------------------------------- |
| auth_sistema     | audit_logs                | user_id                  | auth_sistema     | users                   | id             | audit_logs_user_id_fkey                               |
| auth_sistema     | cargos                    | default_role_code        | auth_sistema     | roles                   | code           | cargos_default_role_code_fkey                         |
| auth_sistema     | user_lojas                | created_by               | auth_sistema     | users                   | id             | user_lojas_created_by_fkey                            |
| auth_sistema     | user_lojas                | user_id                  | auth_sistema     | users                   | id             | user_lojas_user_id_fkey                               |
| auth_sistema     | user_permissions          | permission_code          | auth_sistema     | permissions             | code           | user_permissions_permission_code_fkey                 |
| auth_sistema     | user_permissions          | user_id                  | auth_sistema     | users                   | id             | user_permissions_user_id_fkey                         |
| auth_sistema     | user_permissions          | granted_by               | auth_sistema     | users                   | id             | user_permissions_granted_by_fkey                      |
| auth_sistema     | user_sessions             | user_id                  | auth_sistema     | users                   | id             | user_sessions_user_id_fkey                            |
| auth_sistema     | users                     | updated_by               | auth_sistema     | users                   | id             | users_updated_by_fkey                                 |
| auth_sistema     | users                     | created_by               | auth_sistema     | users                   | id             | users_created_by_fkey                                 |
| auth_sistema     | users                     | rede_id                  | auth_sistema     | redes                   | id             | users_rede_id_fkey                                    |
| auth_sistema     | users                     | manager_id               | auth_sistema     | users                   | id             | users_manager_id_fkey                                 |
| auth_sistema     | users                     | cargo_id                 | auth_sistema     | cargos                  | id             | users_cargo_id_fkey                                   |
| auth_sistema     | users                     | role_code                | auth_sistema     | roles                   | code           | users_role_code_fkey                                  |
| carnes           | apis_uso_log              | api_config_id            | carnes           | apis_configuracao       | id             | apis_uso_log_api_config_id_fkey                       |
| core             | contadores_venda          | loja_id                  | core             | lojas                   | id             | contadores_venda_loja_id_fkey                         |
| core             | endereco_cliente          | cliente_id               | core             | clientes                | id             | endereco_cliente_cliente_id_fkey                      |
| core             | telefones                 | cliente_id               | core             | clientes                | id             | telefones_cliente_id_fkey                             |
| core             | user_roles                | loja_id                  | core             | lojas                   | id             | user_roles_loja_id_fkey                               |
| core             | vendedores                | loja_id                  | core             | lojas                   | id             | vendedores_loja_id_fkey                               |
| core             | vendedores_lojas          | vendedor_id              | core             | vendedores              | id             | fk_vendedores_lojas_vendedor                          |
| core             | vendedores_lojas          | loja_id                  | core             | lojas                   | id             | fk_vendedores_lojas_loja                              |
| fechamento_caixa | movimentacoes             | sessao_id                | fechamento_caixa | sessoes                 | id             | movimentacoes_sessao_id_fkey                          |
| marketing        | agendamentos              | agendamento_original_id  | marketing        | agendamentos            | id             | agendamentos_agendamento_original_id_fkey             |
| marketing        | campanhas                 | template_id              | marketing        | templates               | id             | campanhas_template_id_fkey                            |
| marketing        | campanhas_aniversario     | template_whatsapp_id     | marketing        | templates               | id             | campanhas_aniversario_template_whatsapp_id_fkey       |
| marketing        | campanhas_aniversario     | template_sms_id          | marketing        | templates               | id             | campanhas_aniversario_template_sms_id_fkey            |
| marketing        | campanhas_aniversario     | template_email_id        | marketing        | templates               | id             | campanhas_aniversario_template_email_id_fkey          |
| marketing        | campanhas_recorrentes     | template_whatsapp_id     | marketing        | templates_mensagem      | id             | fk_campanha_template                                  |
| marketing        | cliente_info              | primeira_campanha_id     | marketing        | campanhas               | id             | cliente_info_primeira_campanha_id_fkey                |
| marketing        | cliente_info              | lead_origem_id           | marketing        | leads                   | id             | cliente_info_lead_origem_id_fkey                      |
| marketing        | conversoes_orcamento      | canal_aquisicao_id       | marketing        | canais_aquisicao        | id             | fk_conversao_canal                                    |
| marketing        | conversoes_orcamento      | campanha_id              | marketing        | campanhas               | id             | fk_conversao_campanha                                 |
| marketing        | cupons_aniversario        | campanha_id              | marketing        | campanhas_aniversario   | id             | cupons_aniversario_campanha_id_fkey                   |
| marketing        | envios_campanha_orcamento | lead_id                  | marketing        | leads                   | id             | fk_envio_lead                                         |
| marketing        | envios_campanha_orcamento | campanha_recorrente_id   | marketing        | campanhas_recorrentes   | id             | envios_campanha_orcamento_campanha_recorrente_id_fkey |
| marketing        | interacoes                | lead_id                  | marketing        | leads                   | id             | interacoes_lead_id_fkey                               |
| marketing        | interacoes                | campanha_id              | marketing        | campanhas               | id             | interacoes_campanha_id_fkey                           |
| marketing        | landing_pages             | campanha_id              | marketing        | campanhas               | id             | landing_pages_campanha_id_fkey                        |
| marketing        | leads                     | campanha_id              | marketing        | campanhas               | id             | leads_campanha_id_fkey                                |
| marketing        | mensagens_enviadas        | campanha_id              | marketing        | campanhas               | id             | mensagens_enviadas_campanha_id_fkey                   |
| marketing        | mensagens_enviadas        | lead_id                  | marketing        | leads                   | id             | mensagens_enviadas_lead_id_fkey                       |
| marketing        | sugestoes_campanha        | campanha_criada_id       | marketing        | campanhas               | id             | sugestoes_campanha_campanha_criada_id_fkey            |
| marketing        | sugestoes_campanha        | tendencia_id             | marketing        | tendencias              | id             | sugestoes_campanha_tendencia_id_fkey                  |
| vendas           | autorizacoes              | venda_id                 | vendas           | vendas                  | id             | autorizacoes_venda_id_fkey                            |
| vendas           | contratos_carne           | venda_forma_pagamento_id | vendas           | vendas_formas_pagamento | id             | contratos_carne_venda_forma_pagamento_id_fkey         |
| vendas           | contratos_carne           | venda_id                 | vendas           | vendas                  | id             | contratos_carne_venda_id_fkey                         |
| vendas           | entregas_brindes          | venda_id                 | vendas           | vendas                  | id             | entregas_brindes_venda_id_fkey                        |
| vendas           | entregas_carne            | venda_id                 | vendas           | vendas                  | id             | entregas_carne_venda_id_fkey                          |
| vendas           | entregas_os               | venda_id                 | vendas           | vendas                  | id             | entregas_os_venda_id_fkey                             |
| vendas           | historico_entrada         | venda_id                 | vendas           | vendas                  | id             | historico_entrada_venda_id_fkey                       |
| vendas           | historico_status          | venda_id                 | vendas           | vendas                  | id             | historico_status_venda_id_fkey                        |
| vendas           | itens_venda               | venda_id                 | vendas           | vendas                  | id             | itens_venda_venda_id_fkey                             |
| vendas           | logs_conversao_carne      | venda_id                 | vendas           | vendas                  | id             | logs_conversao_carne_venda_id_fkey                    |
| vendas           | notificacoes_entrada      | venda_id                 | vendas           | vendas                  | id             | notificacoes_entrada_venda_id_fkey                    |
| vendas           | pagamentos                | venda_id                 | vendas           | vendas                  | id             | pagamentos_venda_id_fkey                              |
| vendas           | pagamentos                | forma_pagamento_id       | vendas           | formas_pagamento        | id             | pagamentos_forma_pagamento_id_fkey                    |
| vendas           | pagamentos                | parcela_id               | vendas           | parcelas                | id             | pagamentos_parcela_id_fkey                            |
| vendas           | parcelas                  | venda_id                 | vendas           | vendas                  | id             | parcelas_venda_id_fkey                                |
| vendas           | parcelas                  | venda_forma_pagamento_id | vendas           | vendas_formas_pagamento | id             | parcelas_venda_forma_pagamento_id_fkey                |
| vendas           | recebimentos_carne        | venda_id                 | vendas           | vendas                  | id             | recebimentos_carne_venda_id_fkey                      |
| vendas           | receitas                  | venda_id                 | vendas           | vendas                  | id             | receitas_venda_id_fkey                                |
| vendas           | responsaveis_oticos       | profissional_saude_id    | vendas           | profissionais_saude     | id             | responsaveis_oticos_profissional_saude_id_fkey        |
| vendas           | restantes_entrada         | venda_id                 | vendas           | vendas                  | id             | restantes_entrada_venda_id_fkey                       |
| vendas           | vendas                    | profissional_saude_id    | vendas           | profissionais_saude     | id             | fk_vendas_profissional_saude                          |
| vendas           | vendas_formas_pagamento   | forma_pagamento_id       | vendas           | formas_pagamento        | id             | vendas_formas_pagamento_forma_pagamento_id_fkey       |
| vendas           | vendas_formas_pagamento   | venda_id                 | vendas           | vendas                  | id             | vendas_formas_pagamento_venda_id_fkey                 |
| vendas           | vendas_formas_pagamento   | forma_pagamento_entrada  | vendas           | formas_pagamento        | id             | fk_forma_pagamento_entrada                            |

-- ============================================================================
-- ETAPA 7: CONTAGEM DE REGISTROS
-- ============================================================================
-- Baseado na ETAPA 6 (relacionamentos), as tabelas corretas são:

SELECT 'vendas.vendas' as tabela, COUNT(*) as total FROM vendas.vendas
UNION ALL
SELECT 'vendas.itens_venda' as tabela, COUNT(*) as total FROM vendas.itens_venda
UNION ALL
SELECT 'vendas.receitas' as tabela, COUNT(*) as total FROM vendas.receitas
UNION ALL
SELECT 'vendas.pagamentos' as tabela, COUNT(*) as total FROM vendas.pagamentos
UNION ALL
SELECT 'core.clientes' as tabela, COUNT(*) as total FROM core.clientes
UNION ALL
SELECT 'core.lojas' as tabela, COUNT(*) as total FROM core.lojas
UNION ALL
SELECT 'core.vendedores' as tabela, COUNT(*) as total FROM core.vendedores;


| tabela             | total |
| ------------------ | ----- |
| vendas.vendas      | 14942 |
| vendas.itens_venda | 24    |
| vendas.receitas    | 2     |
| vendas.pagamentos  | 0     |
| core.clientes      | 12473 |
| core.lojas         | 6     |
| core.vendedores    | 66    |


-- ============================================================================
-- ETAPA 8: VIEWS E FUNCTIONS
-- ============================================================================
-- Views disponíveis
SELECT 
    table_schema as schema,
    table_name as view_nome,
    view_definition
FROM information_schema.views
WHERE table_schema NOT IN ('pg_catalog', 'information_schema')
ORDER BY table_schema, table_name;


| schema     | view_nome                       | view_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------- | ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auditoria  | v_ajustes_valores_recentes      |  SELECT entidade_tipo,
    entidade_id,
    campo_nome,
    valor_anterior,
    valor_novo,
    diferenca,
    percentual_variacao,
    tipo_ajuste,
    motivo,
    usuario_nome,
    data_alteracao
   FROM auditoria.historico_valores
  WHERE (data_alteracao >= (CURRENT_DATE - '30 days'::interval))
  ORDER BY (abs(diferenca)) DESC
 LIMIT 100;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| auditoria  | v_alteracoes_por_usuario        |  SELECT usuario_nome,
    usuario_email,
    count(*) AS total_alteracoes,
    count(
        CASE
            WHEN ((operacao)::text = 'INSERT'::text) THEN 1
            ELSE NULL::integer
        END) AS total_inserts,
    count(
        CASE
            WHEN ((operacao)::text = 'UPDATE'::text) THEN 1
            ELSE NULL::integer
        END) AS total_updates,
    count(
        CASE
            WHEN ((operacao)::text = 'DELETE'::text) THEN 1
            ELSE NULL::integer
        END) AS total_deletes,
    max(data_alteracao) AS ultima_alteracao
   FROM auditoria.log_alteracoes
  WHERE (data_alteracao >= (CURRENT_DATE - '30 days'::interval))
  GROUP BY usuario_nome, usuario_email
  ORDER BY (count(*)) DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| auditoria  | v_login_falhados                |  SELECT usuario_email,
    ip_address,
    count(*) AS tentativas,
    max(data_acesso) AS ultima_tentativa,
    array_agg(DISTINCT mensagem_erro) AS erros
   FROM auditoria.acesso_usuarios
  WHERE (((tipo_acesso)::text = 'LOGIN_FAILED'::text) AND (data_acesso >= (CURRENT_DATE - '7 days'::interval)))
  GROUP BY usuario_email, ip_address
 HAVING (count(*) >= 3)
  ORDER BY (count(*)) DESC, (max(data_acesso)) DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| auditoria  | v_resumo_snapshots              |  SELECT data_snapshot,
    tipo_snapshot,
    total_clientes,
    total_vendas,
    total_os,
    valor_total_vendas,
    valor_a_receber,
    ticket_medio,
    nps_medio,
    data_processamento
   FROM auditoria.snapshots_diarios
  ORDER BY data_snapshot DESC, tipo_snapshot
 LIMIT 90;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| auditoria  | v_ultimas_alteracoes            |  SELECT id,
    (((schema_nome)::text || '.'::text) || (tabela_nome)::text) AS tabela_completa,
    operacao,
    registro_id,
    usuario_nome,
    usuario_email,
    data_alteracao,
    campos_alterados,
    ip_address,
    origem
   FROM auditoria.log_alteracoes
  ORDER BY data_alteracao DESC
 LIMIT 1000;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| carnes     | consultas_recentes              |  SELECT id,
    tipo_consulta,
    api_utilizada,
    documento,
    nome_encontrado,
    situacao_cadastral,
    score_credito,
    sucesso,
    usuario_nome,
    motivo,
    consultado_em,
    tempo_resposta_ms
   FROM carnes.consultas_externas
  ORDER BY consultado_em DESC
 LIMIT 100;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| carnes     | dashboard_consultas             |  SELECT count(*) AS total_consultas,
    count(*) FILTER (WHERE (sucesso = true)) AS total_sucesso,
    count(*) FILTER (WHERE (sucesso = false)) AS total_falhas,
    round(((100.0 * (count(*) FILTER (WHERE (sucesso = true)))::numeric) / (NULLIF(count(*), 0))::numeric), 2) AS taxa_sucesso,
    sum(custo_consulta) AS custo_total,
    round(avg(tempo_resposta_ms), 2) AS tempo_medio_ms,
    count(DISTINCT api_utilizada) AS apis_utilizadas,
    count(DISTINCT usuario_id) AS usuarios_unicos,
    count(*) FILTER (WHERE ((restricoes)::text <> '[]'::text)) AS total_com_restricoes,
    round(avg(score_credito), 0) AS score_medio
   FROM carnes.consultas_externas
  WHERE (consultado_em >= (CURRENT_DATE - '30 days'::interval));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| core       | v_user_permissions              |  SELECT auth.uid() AS user_id,
    ur.role,
    ur.loja_id,
    l.codigo AS loja_codigo,
    l.nome AS loja_nome,
    ur.ativo,
        CASE
            WHEN ((ur.role)::text = 'ADMIN'::text) THEN true
            ELSE false
        END AS is_admin,
        CASE
            WHEN ((ur.role)::text = ANY ((ARRAY['ADMIN'::character varying, 'GERENTE'::character varying])::text[])) THEN true
            ELSE false
        END AS is_manager,
        CASE
            WHEN ((ur.role)::text = 'VENDEDOR'::text) THEN true
            ELSE false
        END AS is_vendedor
   FROM (core.user_roles ur
     LEFT JOIN core.lojas l ON ((l.id = ur.loja_id)))
  WHERE ((ur.user_id = auth.uid()) AND (ur.ativo = true));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| core       | vendedores_com_lojas            |  SELECT v.id AS vendedor_id,
    v.nome,
    v.nome_padronizado,
    v.nome_exibicao,
    v.ativo AS vendedor_ativo,
    vl.id AS vendedor_loja_id,
    vl.loja_id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    vl.codigo_vendedor_sistema,
    vl.ativo AS relacao_ativa,
    vl.data_inicio,
    vl.data_fim,
    vl.observacoes AS relacao_observacoes,
    v.created_at AS vendedor_criado_em,
    vl.created_at AS relacao_criada_em
   FROM ((core.vendedores v
     LEFT JOIN core.vendedores_lojas vl ON ((v.id = vl.vendedor_id)))
     LEFT JOIN core.lojas l ON ((vl.loja_id = l.id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| descontos  | vw_relatorio_descontos          |  SELECT hd.id,
    (hd.created_at)::date AS data_desconto,
    hd.venda_id,
    v.numero_venda,
    hd.item_venda_id,
    hd.nome_usuario,
    hd.nome_cargo,
    hd.tipo_desconto,
    hd.percentual_desconto,
    hd.valor_desconto,
    hd.valor_original,
    hd.valor_final,
    hd.economia_cliente,
    hd.motivo,
    hd.categoria_motivo,
    hd.requer_aprovacao,
    hd.aprovado,
    hd.nome_aprovador,
    l.nome AS loja_nome,
    round(((hd.valor_desconto / hd.valor_original) * (100)::numeric), 2) AS percentual_real,
        CASE
            WHEN (hd.requer_aprovacao AND (hd.aprovado IS NULL)) THEN 'PENDENTE'::text
            WHEN (hd.requer_aprovacao AND (hd.aprovado = false)) THEN 'NEGADO'::text
            WHEN (hd.requer_aprovacao AND (hd.aprovado = true)) THEN 'APROVADO'::text
            ELSE 'NAO_REQUER'::text
        END AS status_aprovacao
   FROM ((descontos.historico_descontos hd
     LEFT JOIN vw_vendas v ON ((v.id = hd.venda_id)))
     LEFT JOIN lojas_ativas l ON ((l.id = hd.loja_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions | pg_stat_statements              |  SELECT userid,
    dbid,
    toplevel,
    queryid,
    query,
    plans,
    total_plan_time,
    min_plan_time,
    max_plan_time,
    mean_plan_time,
    stddev_plan_time,
    calls,
    total_exec_time,
    min_exec_time,
    max_exec_time,
    mean_exec_time,
    stddev_exec_time,
    rows,
    shared_blks_hit,
    shared_blks_read,
    shared_blks_dirtied,
    shared_blks_written,
    local_blks_hit,
    local_blks_read,
    local_blks_dirtied,
    local_blks_written,
    temp_blks_read,
    temp_blks_written,
    shared_blk_read_time,
    shared_blk_write_time,
    local_blk_read_time,
    local_blk_write_time,
    temp_blk_read_time,
    temp_blk_write_time,
    wal_records,
    wal_fpi,
    wal_bytes,
    jit_functions,
    jit_generation_time,
    jit_inlining_count,
    jit_inlining_time,
    jit_optimization_count,
    jit_optimization_time,
    jit_emission_count,
    jit_emission_time,
    jit_deform_count,
    jit_deform_time,
    stats_since,
    minmax_stats_since
   FROM pg_stat_statements(true) pg_stat_statements(userid, dbid, toplevel, queryid, query, plans, total_plan_time, min_plan_time, max_plan_time, mean_plan_time, stddev_plan_time, calls, total_exec_time, min_exec_time, max_exec_time, mean_exec_time, stddev_exec_time, rows, shared_blks_hit, shared_blks_read, shared_blks_dirtied, shared_blks_written, local_blks_hit, local_blks_read, local_blks_dirtied, local_blks_written, temp_blks_read, temp_blks_written, shared_blk_read_time, shared_blk_write_time, local_blk_read_time, local_blk_write_time, temp_blk_read_time, temp_blk_write_time, wal_records, wal_fpi, wal_bytes, jit_functions, jit_generation_time, jit_inlining_count, jit_inlining_time, jit_optimization_count, jit_optimization_time, jit_emission_count, jit_emission_time, jit_deform_count, jit_deform_time, stats_since, minmax_stats_since);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions | pg_stat_statements_info         |  SELECT dealloc,
    stats_reset
   FROM pg_stat_statements_info() pg_stat_statements_info(dealloc, stats_reset);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| marketing  | v_analise_conversoes            |  SELECT c.id,
    c.orcamento_id,
    c.venda_id,
    c.cliente_id,
    cl.nome AS cliente_nome,
    ca.codigo AS canal_codigo,
    ca.nome AS canal_nome,
    ca.categoria AS canal_categoria,
    camp.nome AS campanha_nome,
    c.primeira_compra,
    c.tempo_conversao_dias,
    c.valor_orcamento,
    c.valor_venda,
    c.desconto_aplicado,
    c.indicado_por,
    cli_ind.nome AS indicador_nome,
    c.criado_em AS data_conversao
   FROM ((((marketing.conversoes_orcamento c
     LEFT JOIN core.clientes cl ON ((cl.id = c.cliente_id)))
     LEFT JOIN marketing.canais_aquisicao ca ON ((ca.id = c.canal_aquisicao_id)))
     LEFT JOIN marketing.campanhas camp ON ((camp.id = c.campanha_id)))
     LEFT JOIN core.clientes cli_ind ON ((cli_ind.id = c.indicado_por_cliente_id)))
  ORDER BY c.criado_em DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| marketing  | v_performance_canais_conversao  |  SELECT ca.id,
    ca.codigo,
    ca.nome,
    ca.categoria,
    count(*) AS total_conversoes,
    count(*) FILTER (WHERE (c.primeira_compra = true)) AS conversoes_primeira_compra,
    sum(c.valor_venda) AS receita_total,
    avg(c.valor_venda) AS ticket_medio,
    sum(c.desconto_aplicado) AS total_descontos,
    avg(c.tempo_conversao_dias) AS tempo_medio_conversao_dias,
    round((((count(*))::numeric / (NULLIF(( SELECT count(*) AS count
           FROM vendas.orcamentos
          WHERE ((orcamentos.status)::text <> 'convertido'::text)), 0))::numeric) * (100)::numeric), 2) AS taxa_conversao_percent
   FROM (marketing.canais_aquisicao ca
     LEFT JOIN marketing.conversoes_orcamento c ON ((c.canal_aquisicao_id = ca.id)))
  WHERE (ca.ativo = true)
  GROUP BY ca.id, ca.codigo, ca.nome, ca.categoria
  ORDER BY (count(*)) DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| marketing  | view_dashboard_orcamentos       |  SELECT cr.id AS campanha_id,
    cr.nome AS campanha_nome,
    cr.status,
    cr.ultima_execucao,
    cr.proxima_execucao,
    cr.total_leads_processados,
    cr.total_envios_realizados,
    count(eco.id) AS envios_periodo,
    count(eco.id) FILTER (WHERE (eco.respondeu_em IS NOT NULL)) AS respostas_periodo,
    count(eco.id) FILTER (WHERE (eco.converteu_em IS NOT NULL)) AS conversoes_periodo,
        CASE
            WHEN (count(eco.id) > 0) THEN round((((count(eco.id) FILTER (WHERE (eco.converteu_em IS NOT NULL)))::numeric * 100.0) / (count(eco.id))::numeric), 2)
            ELSE (0)::numeric
        END AS taxa_conversao_pct,
    count(eco2.id) AS envios_proximas_24h
   FROM ((marketing.campanhas_recorrentes cr
     LEFT JOIN marketing.envios_campanha_orcamento eco ON (((cr.id = eco.campanha_recorrente_id) AND (eco.criado_em >= (now() - '30 days'::interval)))))
     LEFT JOIN marketing.envios_campanha_orcamento eco2 ON (((cr.id = eco2.campanha_recorrente_id) AND ((eco2.proximo_envio >= now()) AND (eco2.proximo_envio <= (now() + '24:00:00'::interval))) AND ((eco2.status)::text = 'ATIVO'::text))))
  WHERE (cr.tipo = 'ORCAMENTO_FOLLOWUP'::tipo_campanha_recorrente)
  GROUP BY cr.id, cr.nome, cr.status, cr.ultima_execucao, cr.proxima_execucao, cr.total_leads_processados, cr.total_envios_realizados;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| pagamentos | v_analise_carnes                |  SELECT cc.cliente_uuid,
    rc.cliente_nome,
    cc.plano_pagamento,
    cc.total_parcelas_previstas,
    cc.parcelas_pagas,
    cc.valor_total_pago,
    cc.percentual_completude,
    cc.status_carne,
        CASE
            WHEN (cc.percentual_completude = (100)::numeric) THEN 'FINALIZADO'::text
            WHEN (cc.percentual_completude >= (75)::numeric) THEN 'QUASE_COMPLETO'::text
            WHEN (cc.percentual_completude >= (50)::numeric) THEN 'MEIO_CAMINHO'::text
            WHEN (cc.percentual_completude >= (25)::numeric) THEN 'INICIO'::text
            ELSE 'ABANDONO_RISCO'::text
        END AS fase_carne,
    cc.data_ultimo_pagamento
   FROM (pagamentos.controle_carnes cc
     LEFT JOIN pagamentos.resumo_clientes rc ON ((cc.cliente_uuid = rc.cliente_uuid)))
  ORDER BY cc.percentual_completude DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| pagamentos | v_entradas_completas            |  SELECT id,
    cliente_uuid,
    cliente_nome,
    data_pagamento,
    valor_parcela,
    numero_parcela,
    total_parcelas,
    plano_pagamento,
    historico_completo,
        CASE
            WHEN ((numero_parcela IS NOT NULL) AND (total_parcelas IS NOT NULL)) THEN concat(numero_parcela, '/', total_parcelas)
            ELSE 'N/A'::text
        END AS parcela_info,
        CASE
            WHEN (data_pagamento >= (CURRENT_DATE - '30 days'::interval)) THEN 'RECENTE'::text
            WHEN (data_pagamento >= (CURRENT_DATE - '90 days'::interval)) THEN 'MEDIO'::text
            ELSE 'ANTIGO'::text
        END AS status_temporal,
    created_at
   FROM pagamentos.entradas_carne ec
  ORDER BY data_pagamento DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| pagamentos | v_top_clientes                  |  SELECT cliente_uuid,
    cliente_nome,
    total_parcelas_pagas,
    valor_total_pago,
    score_pagamento,
    primeiro_pagamento,
    ultimo_pagamento,
        CASE
            WHEN (ultimo_pagamento >= (CURRENT_DATE - '30 days'::interval)) THEN 'ATIVO'::text
            WHEN (ultimo_pagamento >= (CURRENT_DATE - '90 days'::interval)) THEN 'MODERADO'::text
            ELSE 'INATIVO'::text
        END AS status_atividade,
    round((valor_total_pago / (GREATEST(total_parcelas_pagas, 1))::numeric), 2) AS valor_medio_parcela
   FROM pagamentos.resumo_clientes rc
  WHERE (valor_total_pago > (0)::numeric)
  ORDER BY valor_total_pago DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | admin_equipe_por_loja           |  SELECT l.id AS loja_id,
    l.codigo AS loja_codigo,
    l.nome AS loja_nome,
    u.id AS usuario_id,
    u.nome_completo,
    u.email,
    u.telefone,
    u.role_code,
    r.name AS role_name,
    c.name AS cargo_nome,
    u.status,
    u.ultimo_acesso
   FROM ((((core.lojas l
     JOIN auth_sistema.redes re ON ((l.rede_id = re.id)))
     JOIN auth_sistema.users u ON ((u.rede_id = re.id)))
     LEFT JOIN auth_sistema.roles r ON (((u.role_code)::text = (r.code)::text)))
     LEFT JOIN auth_sistema.cargos c ON ((u.cargo_id = c.id)))
  WHERE (l.ativo = true)
  ORDER BY l.codigo, u.nome_completo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public     | admin_lojas_completo            |  SELECT l.id,
    l.codigo,
    l.nome,
    l.nome_fantasia,
    l.cnpj,
    l.cidade,
    l.estado,
    l.endereco_completo,
    l.telefone,
    l.email,
    l.whatsapp,
    l.instagram,
    l.facebook,
    l.ativo,
    l.data_abertura,
    l.data_fechamento,
    l.configuracao_email,
    l.horario_funcionamento,
    l.zapi_instance_id,
    l.zapi_token,
    l.rede_id,
    r.nome AS rede_nome,
    rt.profissional_saude_id AS responsavel_id,
    ps.nome AS responsavel_nome,
    ps.tipo_profissional AS responsavel_tipo,
        CASE
            WHEN ((ps.tipo_profissional)::text = 'MEDICO_OFTALMOLOGISTA'::text) THEN (((('CRM '::text || (ps.crm)::text) || '/'::text) || (ps.crm_uf)::text))::character varying
            WHEN ((ps.tipo_profissional)::text = 'OPTOMETRISTA'::text) THEN (((('CRO '::text || (ps.cro)::text) || '/'::text) || (ps.cro_uf)::text))::character varying
            ELSE ps.registro_profissional
        END AS responsavel_registro,
    ps.celular AS responsavel_celular,
    rt.numero_alvara,
    rt.alvara_valido_ate,
    ( SELECT count(*) AS count
           FROM auth_sistema.users u
          WHERE (u.rede_id = l.rede_id)) AS qtd_funcionarios_rede,
    ( SELECT count(*) AS count
           FROM vendas.vendas v
          WHERE ((v.loja_id = l.id) AND (v.data_venda >= (CURRENT_DATE - '30 days'::interval)))) AS vendas_ultimos_30_dias,
    ( SELECT COALESCE(sum(v.valor_total), (0)::numeric) AS "coalesce"
           FROM vendas.vendas v
          WHERE ((v.loja_id = l.id) AND (v.data_venda >= (CURRENT_DATE - '30 days'::interval)))) AS faturamento_30_dias,
        CASE
            WHEN (NOT l.ativo) THEN 'LOJA_INATIVA'::text
            WHEN (rt.id IS NULL) THEN 'SEM_RESPONSAVEL_TECNICO'::text
            WHEN ((rt.alvara_valido_ate IS NOT NULL) AND (rt.alvara_valido_ate < CURRENT_DATE)) THEN 'ALVARA_VENCIDO'::text
            WHEN ((rt.alvara_valido_ate IS NOT NULL) AND (rt.alvara_valido_ate <= (CURRENT_DATE + '30 days'::interval))) THEN 'ALVARA_VENCE_EM_BREVE'::text
            ELSE 'OK'::text
        END AS alerta_compliance
   FROM (((core.lojas l
     LEFT JOIN auth_sistema.redes r ON ((l.rede_id = r.id)))
     LEFT JOIN vendas.responsaveis_oticos rt ON (((l.id = rt.loja_id) AND (rt.data_fim IS NULL))))
     LEFT JOIN vendas.profissionais_saude ps ON ((rt.profissional_saude_id = ps.id)))
  ORDER BY l.codigo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public     | admin_pessoal_completo          |  SELECT u.id,
    u.email,
    u.nome_completo,
    u.apelido,
    u.cpf,
    u.rg,
    u.telefone,
    u.data_nascimento,
    u.sexo,
    u.avatar_url,
    u.role_code,
    r.name AS role_name,
    r.description AS role_descricao,
    c.name AS cargo_nome,
    c.description AS cargo_descricao,
    c.salary_range_min AS salario_minimo,
    c.salary_range_max AS salario_maximo,
    u.manager_id,
    m.nome_completo AS manager_nome,
    m.email AS manager_email,
    u.rede_id,
    re.nome AS rede_nome,
    u.status,
    u.email_verified,
    u.phone_verified,
    u.failed_login_count,
    u.blocked_until,
    u.last_password_change,
    u.ultimo_acesso,
    u.ultimo_ip,
    au.created_at AS auth_created_at,
    au.last_sign_in_at,
    au.confirmed_at AS email_confirmed_at,
    u.created_at,
    u.updated_at,
        CASE
            WHEN ((u.status)::text = 'active'::text) THEN 'Ativo'::character varying
            WHEN ((u.status)::text = 'inactive'::text) THEN 'Inativo'::character varying
            WHEN ((u.status)::text = 'blocked'::text) THEN 'Bloqueado'::character varying
            WHEN ((u.status)::text = 'pending'::text) THEN 'Pendente'::character varying
            ELSE u.status
        END AS status_formatado,
        CASE
            WHEN ((u.blocked_until IS NOT NULL) AND (u.blocked_until > now())) THEN 'BLOQUEADO_TEMPORARIAMENTE'::text
            WHEN (u.failed_login_count >= 5) THEN 'MUITAS_TENTATIVAS_FALHAS'::text
            WHEN ((u.last_password_change IS NOT NULL) AND (u.last_password_change < (now() - '90 days'::interval))) THEN 'SENHA_ANTIGA'::text
            WHEN (NOT u.email_verified) THEN 'EMAIL_NAO_VERIFICADO'::text
            ELSE 'OK'::text
        END AS alerta_seguranca,
        CASE
            WHEN (u.ultimo_acesso IS NOT NULL) THEN (EXTRACT(day FROM (now() - (u.ultimo_acesso)::timestamp with time zone)))::integer
            ELSE NULL::integer
        END AS dias_sem_acessar
   FROM (((((auth_sistema.users u
     LEFT JOIN auth_sistema.roles r ON (((u.role_code)::text = (r.code)::text)))
     LEFT JOIN auth_sistema.cargos c ON ((u.cargo_id = c.id)))
     LEFT JOIN auth_sistema.users m ON ((u.manager_id = m.id)))
     LEFT JOIN auth_sistema.redes re ON ((u.rede_id = re.id)))
     LEFT JOIN auth.users au ON ((u.id = au.id)))
  ORDER BY u.nome_completo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | admin_profissionais_saude       |  SELECT ps.id,
    ps.nome,
    ps.cpf,
    ps.rg,
    ps.data_nascimento,
    ps.telefone,
    ps.celular,
    ps.email,
    ps.cep,
    ps.logradouro,
    ps.numero,
    ps.complemento,
    ps.bairro,
    ps.cidade,
    ps.estado,
    ((((((((((ps.logradouro)::text || ', '::text) || (ps.numero)::text) || COALESCE((' - '::text || (ps.complemento)::text), ''::text)) || ' - '::text) || (ps.bairro)::text) || ', '::text) || (ps.cidade)::text) || '/'::text) || (ps.estado)::text) AS endereco_completo,
    ps.tipo_profissional,
        CASE
            WHEN ((ps.tipo_profissional)::text = 'MEDICO_OFTALMOLOGISTA'::text) THEN 'Médico Oftalmologista'::character varying
            WHEN ((ps.tipo_profissional)::text = 'OPTOMETRISTA'::text) THEN 'Optometrista'::character varying
            WHEN ((ps.tipo_profissional)::text = 'ORTOPTISTA'::text) THEN 'Ortoptista'::character varying
            WHEN ((ps.tipo_profissional)::text = 'TECNICO_OPTICA'::text) THEN 'Técnico em Óptica'::character varying
            ELSE ps.tipo_profissional
        END AS tipo_profissional_formatado,
    ps.crm,
    ps.crm_uf,
    ps.cro,
    ps.cro_uf,
    ps.registro_profissional,
        CASE
            WHEN ((ps.tipo_profissional)::text = 'MEDICO_OFTALMOLOGISTA'::text) THEN ((('CRM '::text || (ps.crm)::text) || '/'::text) || (ps.crm_uf)::text)
            WHEN ((ps.tipo_profissional)::text = 'OPTOMETRISTA'::text) THEN ((('CRO '::text || (ps.cro)::text) || '/'::text) || (ps.cro_uf)::text)
            ELSE ('Registro: '::text || (ps.registro_profissional)::text)
        END AS registro_formatado,
    ps.status,
    ps.data_registro_valido_ate,
        CASE
            WHEN (ps.data_registro_valido_ate IS NULL) THEN true
            WHEN (ps.data_registro_valido_ate >= CURRENT_DATE) THEN true
            ELSE false
        END AS registro_vigente,
    ps.loja_id,
    l.codigo AS loja_codigo,
    l.nome AS loja_nome,
    ps.especialidades,
    ps.observacoes,
    ps.documento_registro_url,
    ps.documento_identidade_url,
    ps.criado_por,
    ps.criado_em,
    ps.atualizado_em,
    (EXISTS ( SELECT 1
           FROM vendas.responsaveis_oticos ro
          WHERE ((ro.profissional_saude_id = ps.id) AND (ro.data_fim IS NULL)))) AS e_responsavel_tecnico,
    ( SELECT count(*) AS count
           FROM vendas.responsaveis_oticos ro
          WHERE ((ro.profissional_saude_id = ps.id) AND (ro.data_fim IS NULL))) AS qtd_lojas_responsavel
   FROM (vendas.profissionais_saude ps
     LEFT JOIN core.lojas l ON ((ps.loja_id = l.id)))
  ORDER BY ps.nome;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public     | caixa_movimentacoes             |  SELECT id,
    sessao_id,
    tipo,
    valor,
    descricao,
    venda_id,
    created_at,
    created_by
   FROM fechamento_caixa.movimentacoes;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | caixa_sessoes                   |  SELECT id,
    loja_id,
    user_id,
    data_abertura,
    data_fechamento,
    valor_inicial,
    valor_fechamento_informado,
    valor_fechamento_calculado,
    valor_diferenca,
    status,
    observacoes,
    created_at,
    updated_at,
    valor_vendas,
    valor_despesas,
    valor_sangrias,
    valor_suprimentos,
    valor_pagamentos_adicionais,
    total_entregas,
    resumo_automatico,
    quebra_por_forma_pagamento
   FROM fechamento_caixa.sessoes;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | canais_aquisicao                |  SELECT id,
    codigo,
    nome,
    descricao,
    categoria,
    ativo,
    criado_em,
    atualizado_em
   FROM marketing.canais_aquisicao;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | cargos                          |  SELECT c.id,
    c.default_role_code AS code,
    c.name,
    c.description,
    COALESCE(r.level, 99) AS hierarchy_level,
    c.salary_range_min AS base_salary,
        CASE
            WHEN ((c.default_role_code)::text = ANY ((ARRAY['SELLER'::character varying, 'SELLER_SENIOR'::character varying, 'SUPERVISOR'::character varying, 'MANAGER'::character varying])::text[])) THEN true
            ELSE false
        END AS is_sales_role,
    c.default_role_code,
    c.requires_approval,
    c.active,
    c.created_at,
    c.updated_at
   FROM (auth_sistema.cargos c
     LEFT JOIN auth_sistema.roles r ON (((c.default_role_code)::text = (r.code)::text)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public     | clientes                        |  SELECT id,
    id_legado,
    nome,
    nome_normalizado,
    cpf,
    rg,
    data_nascimento,
    sexo,
    email,
    status,
    origem,
    tags,
    observacoes,
    lead_origem_id,
    created_at,
    updated_at,
    deleted_at
   FROM core.clientes
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | config_descontos_por_cargo      |  SELECT id,
    cargo_id,
    nome_cargo,
    tipo_desconto,
    percentual_minimo,
    percentual_maximo,
    valor_minimo,
    valor_maximo,
    requer_aprovacao,
    aprovador_cargo_id,
    aplica_item_individual,
    aplica_venda_total,
    produtos_excluidos,
    ativo,
    observacoes,
    created_at,
    updated_at,
    created_by,
    updated_by,
    tipo_produto
   FROM descontos.config_descontos_por_cargo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | configuracoes_juros             |  SELECT id,
    nome_configuracao,
    prazo_meses,
    taxa_mensal,
    taxa_anual,
    sistema_amortizacao,
    valor_minimo,
    valor_maximo,
    parcelas_minimas,
    parcelas_maximas,
    cet_mensal,
    cet_anual,
    descricao,
    ativa,
    padrao
   FROM carnes.config_taxas_juros
  WHERE (ativa = true)
  ORDER BY padrao DESC, parcelas_minimas;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | contratos_carne                 |  SELECT id,
    venda_id,
    venda_forma_pagamento_id,
    numero_contrato,
    data_contrato,
    assinatura_cliente,
    assinatura_vendedor,
    cpf_cliente,
    nome_cliente,
    nome_vendedor,
    foto_documento_frente,
    foto_documento_verso,
    testemunha1_nome,
    testemunha1_cpf,
    testemunha1_assinatura,
    testemunha2_nome,
    testemunha2_cpf,
    testemunha2_assinatura,
    ip_address,
    user_agent,
    timestamp_assinatura,
    pdf_url,
    pdf_gerado,
    status,
    created_at,
    updated_at,
    created_by
   FROM vendas.contratos_carne;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | endereco_cliente                |  SELECT id,
    cliente_id,
    tipo,
    cep,
    logradouro,
    numero,
    complemento,
    bairro,
    cidade,
    estado,
    pais,
    principal,
    created_at,
    updated_at,
    deleted_at
   FROM core.endereco_cliente
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | formas_pagamento                |  SELECT id,
    codigo,
    nome,
    categoria,
    ativo,
    ordem_exibicao,
    created_at,
    updated_at,
    permite_parcelamento,
    parcelas_minimas,
    parcelas_maximas,
    taxa_juros_mensal,
    desconto_avista_percentual,
    tipo_forma,
    exige_entrada,
    percentual_entrada_minimo,
    aplica_desconto_automatico,
    observacoes
   FROM vendas.formas_pagamento;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | formas_pagamento_disponiveis    |  SELECT id,
    codigo,
    nome,
    categoria,
    ativo,
    ordem_exibicao,
    permite_parcelamento,
    parcelas_minimas,
    parcelas_maximas,
    taxa_juros_mensal,
    desconto_avista_percentual,
    tipo_forma,
    exige_entrada,
    percentual_entrada_minimo,
    aplica_desconto_automatico,
    observacoes
   FROM vendas.formas_pagamento
  WHERE (ativo = true)
  ORDER BY ordem_exibicao;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | itens_venda                     |  SELECT id,
    venda_id,
    tipo_produto,
    descricao,
    marca,
    modelo,
    codigo_produto,
    codigo_barras,
    cor,
    tamanho,
    material,
    fornecedor,
    codigo_fornecedor,
    quantidade,
    valor_unitario,
    valor_desconto,
    valor_total,
    possui_estoque,
    requer_encomenda,
    data_encomenda,
    data_prevista_chegada,
    observacoes,
    created_at,
    updated_at,
    deleted_at,
    updated_by,
    produto_uuid,
    produto_sku_visual,
    produto_origem,
    lente_uuid,
    lente_nome_normalizado,
    lente_fabricante,
    lente_tipo,
    tratamento,
    grau_od,
    grau_oe,
    adicao,
    dnp_od,
    dnp_oe
   FROM vendas.itens_venda;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | limites_desconto_por_cargo      |  SELECT cargo_id,
    nome_cargo,
    tipo_desconto,
    percentual_maximo,
    valor_maximo,
    requer_aprovacao,
    tipo_produto
   FROM descontos.config_descontos_por_cargo
  WHERE (ativo = true);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public     | limites_desconto_por_usuario    |  SELECT u.id AS usuario_id,
    u.email,
    u.nome_completo,
    u.role_code,
    r.id AS role_id,
    r.name AS role_name,
    r.max_discount_percent AS limite_desconto_percentual,
        CASE
            WHEN (r.max_discount_percent >= (100)::numeric) THEN NULL::numeric
            WHEN (r.max_discount_percent >= (50)::numeric) THEN r.max_discount_percent
            ELSE (r.max_discount_percent * 0.8)
        END AS requer_autorizacao_acima,
        CASE
            WHEN (r.level <= 2) THEN true
            ELSE false
        END AS pode_autorizar_outros,
    v.id AS vendedor_id
   FROM ((auth_sistema.users u
     JOIN auth_sistema.roles r ON (((u.role_code)::text = (r.code)::text)))
     LEFT JOIN core.vendedores v ON ((v.user_id = u.id)))
  WHERE ((u.status)::text = 'active'::text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | lojas_ativas                    |  SELECT id,
    codigo,
    nome,
    nome_fantasia,
    cnpj,
    cidade,
    estado,
    endereco_completo,
    telefone,
    email,
    whatsapp,
    instagram,
    facebook,
    ativo,
    data_abertura,
    horario_funcionamento,
    configuracao_email,
    created_at,
    updated_at
   FROM core.lojas l
  WHERE ((ativo = true) AND (deleted_at IS NULL))
  ORDER BY nome;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public     | orcamentos                      |  SELECT id,
    numero_orcamento,
    loja_id,
    cliente_id,
    vendedor_id,
    nome_contato,
    telefone_contato,
    email_contato,
    data_orcamento,
    validade,
    itens,
    valor_total,
    desconto,
    status,
    observacoes,
    created_at,
    updated_at
   FROM vendas.orcamentos;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public     | parcelas                        |  SELECT id,
    venda_id,
    venda_forma_pagamento_id,
    numero_parcela,
    valor,
    data_vencimento,
    data_pagamento,
    status,
    eh_entrada,
    forma_pagamento_entrada,
    created_at,
    updated_at
   FROM vendas.parcelas;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | parcelas_com_juros              |  SELECT p.id,
    p.venda_id,
    v.numero_venda,
    v.cliente_id,
    v.vendedor_id,
    p.numero_parcela,
    p.valor AS valor_original,
    p.data_vencimento,
    p.data_pagamento,
    p.status,
    p.eh_entrada,
        CASE
            WHEN (((p.status)::text = 'VENCIDO'::text) AND (p.data_pagamento IS NULL)) THEN GREATEST(0, (CURRENT_DATE - p.data_vencimento))
            ELSE 0
        END AS dias_atraso_atual,
    p.multa_percentual,
    p.juros_dia_percentual,
    p.valor_multa,
    p.valor_juros_atraso,
    p.valor_total_com_juros,
    c.nome AS cliente_nome,
    vend.nome AS vendedor_nome
   FROM (((vendas.parcelas p
     JOIN vendas.vendas v ON ((v.id = p.venda_id)))
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  ORDER BY p.data_vencimento;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public     | profissionais_para_receitas     |  SELECT id,
    nome,
    tipo_profissional,
        CASE
            WHEN ((tipo_profissional)::text = 'MEDICO_OFTALMOLOGISTA'::text) THEN (((('CRM '::text || (COALESCE(crm, 'N/A'::character varying))::text) || ' - '::text) || (COALESCE(crm_uf, 'N/A'::character varying))::text))::character varying
            WHEN ((tipo_profissional)::text = 'OPTOMETRISTA'::text) THEN (((('CRO '::text || (COALESCE(cro, 'N/A'::character varying))::text) || ' - '::text) || (COALESCE(cro_uf, 'N/A'::character varying))::text))::character varying
            ELSE COALESCE(registro_profissional, 'N/A'::character varying)
        END AS registro_formatado,
    telefone,
    status
   FROM vendas.profissionais_saude
  WHERE ((status)::text = 'ATIVO'::text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | profissionais_saude             |  SELECT id,
    nome,
    cpf,
    tipo_profissional,
    crm,
    crm_uf,
    cro,
    cro_uf,
    registro_profissional,
    status,
    data_registro_valido_ate,
    telefone,
    celular,
    email,
    especialidades,
    observacoes,
    loja_id,
        CASE
            WHEN (data_registro_valido_ate IS NULL) THEN true
            WHEN (data_registro_valido_ate >= CURRENT_DATE) THEN true
            ELSE false
        END AS registro_valido,
        CASE
            WHEN ((tipo_profissional)::text = 'MEDICO_OFTALMOLOGISTA'::text) THEN ((((crm)::text || '/'::text) || (crm_uf)::text))::character varying
            WHEN ((tipo_profissional)::text = 'OPTOMETRISTA'::text) THEN ((((cro)::text || '/'::text) || (cro_uf)::text))::character varying
            ELSE registro_profissional
        END AS registro_principal,
    criado_em,
    atualizado_em
   FROM vendas.profissionais_saude ps;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public     | receitas                        |  SELECT id,
    cliente_id,
    venda_id,
    medico,
    data_receita,
    od_esferico,
    od_cilindrico,
    od_eixo,
    od_adicao,
    oe_esferico,
    oe_cilindrico,
    oe_eixo,
    oe_adicao,
    observacoes,
    created_at,
    updated_at,
    tipo_visao,
    modo_adicao,
    od_esferico_perto,
    od_altura,
    oe_esferico_perto,
    oe_altura,
    arquivo_url,
    arquivo_tipo,
    arquivo_tamanho,
    arquivo_nome_original,
    uploaded_at,
    uploaded_by
   FROM vendas.receitas;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public     | responsaveis_oticos             |  SELECT ro.id,
    ro.loja_id,
    ro.profissional_saude_id,
    ro.data_inicio,
    ro.data_fim,
    ro.status,
    ro.numero_alvara,
    ro.data_alvara,
    ro.alvara_valido_ate,
    ro.termo_responsabilidade_url,
    ro.anotacao_responsabilidade_tecnica,
    ro.horario_presenca_inicio,
    ro.horario_presenca_fim,
    ro.dias_semana_presenca,
    ro.observacoes,
    ps.nome AS profissional_nome,
    ps.cpf AS profissional_cpf,
    ps.tipo_profissional,
    ps.crm,
    ps.crm_uf,
    ps.cro,
    ps.cro_uf,
        CASE
            WHEN ((ro.data_fim IS NULL) AND ((ro.status)::text = 'ATIVO'::text)) THEN true
            ELSE false
        END AS esta_ativo,
        CASE
            WHEN (ro.alvara_valido_ate IS NULL) THEN NULL::boolean
            WHEN (ro.alvara_valido_ate >= CURRENT_DATE) THEN true
            ELSE false
        END AS alvara_vigente,
        CASE
            WHEN (ps.data_registro_valido_ate IS NULL) THEN true
            WHEN (ps.data_registro_valido_ate >= CURRENT_DATE) THEN true
            ELSE false
        END AS registro_profissional_vigente,
    ro.criado_em,
    ro.atualizado_em
   FROM (vendas.responsaveis_oticos ro
     JOIN vendas.profissionais_saude ps ON ((ro.profissional_saude_id = ps.id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | responsaveis_oticos_ativos      |  SELECT ro.id,
    ro.loja_id,
    l.nome AS loja_nome,
    ro.profissional_saude_id,
    ps.nome AS profissional_nome,
    ps.tipo_profissional,
    ps.crm,
    ps.crm_uf,
    ps.cro,
    ps.cro_uf,
    ps.telefone AS profissional_telefone,
    ps.celular AS profissional_celular,
    ps.email AS profissional_email,
    ro.data_inicio,
    ro.numero_alvara,
    ro.alvara_valido_ate,
    ro.horario_presenca_inicio,
    ro.horario_presenca_fim,
    ro.dias_semana_presenca,
        CASE
            WHEN ((ro.alvara_valido_ate IS NOT NULL) AND (ro.alvara_valido_ate < CURRENT_DATE)) THEN 'ALVARA_VENCIDO'::text
            WHEN ((ro.alvara_valido_ate IS NOT NULL) AND (ro.alvara_valido_ate <= (CURRENT_DATE + '30 days'::interval))) THEN 'ALVARA_VENCE_EM_30_DIAS'::text
            WHEN ((ps.data_registro_valido_ate IS NOT NULL) AND (ps.data_registro_valido_ate < CURRENT_DATE)) THEN 'REGISTRO_VENCIDO'::text
            WHEN ((ps.data_registro_valido_ate IS NOT NULL) AND (ps.data_registro_valido_ate <= (CURRENT_DATE + '30 days'::interval))) THEN 'REGISTRO_VENCE_EM_30_DIAS'::text
            ELSE 'OK'::text
        END AS status_compliance,
    ro.criado_em,
    ro.atualizado_em
   FROM ((vendas.responsaveis_oticos ro
     JOIN vendas.profissionais_saude ps ON ((ro.profissional_saude_id = ps.id)))
     JOIN core.lojas l ON ((ro.loja_id = l.id)))
  WHERE (((ro.status)::text = 'ATIVO'::text) AND (ro.data_fim IS NULL) AND ((ps.status)::text = 'ATIVO'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public     | resumo_dia                      |  WITH vendas_dia AS (
         SELECT vendas.loja_id,
            count(*) AS total_vendas,
            sum(vendas.valor_total) AS valor_total_vendas,
            sum(vendas.valor_entrada) AS valor_entradas,
            sum(vendas.valor_restante) AS valor_restante
           FROM vendas.vendas
          WHERE ((vendas.data_venda = CURRENT_DATE) AND (vendas.deleted_at IS NULL))
          GROUP BY vendas.loja_id
        ), caixas_abertos AS (
         SELECT sessoes.loja_id,
            sessoes.id AS sessao_id,
            sessoes.valor_inicial,
            sessoes.data_abertura
           FROM fechamento_caixa.sessoes
          WHERE (sessoes.status = 'ABERTA'::text)
        ), movimentacoes_dia AS (
         SELECT s.loja_id,
            m.tipo,
            sum(m.valor) AS total
           FROM (fechamento_caixa.movimentacoes m
             JOIN fechamento_caixa.sessoes s ON ((m.sessao_id = s.id)))
          WHERE (date(m.created_at) = CURRENT_DATE)
          GROUP BY s.loja_id, m.tipo
        )
 SELECT l.id AS loja_id,
    l.nome AS loja_nome,
    c.sessao_id,
    c.valor_inicial,
    c.data_abertura,
        CASE
            WHEN (c.sessao_id IS NOT NULL) THEN true
            ELSE false
        END AS caixa_aberto,
    COALESCE(v.total_vendas, (0)::bigint) AS total_vendas,
    COALESCE(v.valor_total_vendas, (0)::numeric) AS valor_total_vendas,
    COALESCE(v.valor_entradas, (0)::numeric) AS valor_entradas,
    COALESCE(v.valor_restante, (0)::numeric) AS valor_restante,
    COALESCE(( SELECT movimentacoes_dia.total
           FROM movimentacoes_dia
          WHERE ((movimentacoes_dia.loja_id = l.id) AND (movimentacoes_dia.tipo = 'SUPRIMENTO'::text))), (0)::numeric) AS valor_suprimentos,
    COALESCE(( SELECT movimentacoes_dia.total
           FROM movimentacoes_dia
          WHERE ((movimentacoes_dia.loja_id = l.id) AND (movimentacoes_dia.tipo = 'SANGRIA'::text))), (0)::numeric) AS valor_sangrias,
    (((COALESCE(c.valor_inicial, (0)::numeric) + COALESCE(v.valor_entradas, (0)::numeric)) + COALESCE(( SELECT movimentacoes_dia.total
           FROM movimentacoes_dia
          WHERE ((movimentacoes_dia.loja_id = l.id) AND (movimentacoes_dia.tipo = 'SUPRIMENTO'::text))), (0)::numeric)) - COALESCE(( SELECT movimentacoes_dia.total
           FROM movimentacoes_dia
          WHERE ((movimentacoes_dia.loja_id = l.id) AND (movimentacoes_dia.tipo = 'SANGRIA'::text))), (0)::numeric)) AS saldo_atual,
    CURRENT_TIMESTAMP AS atualizado_em
   FROM ((core.lojas l
     LEFT JOIN caixas_abertos c ON ((l.id = c.loja_id)))
     LEFT JOIN vendas_dia v ON ((l.id = v.loja_id)))
  WHERE (l.ativo = true)
  ORDER BY l.nome;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | roles                           |  SELECT id,
    code,
    name,
    description,
    level AS hierarchy_level,
    level,
    permissions,
    can_manage_users,
    can_view_all_stores,
    max_discount_percent,
    active,
    created_at,
    updated_at
   FROM auth_sistema.roles r;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public     | telefones                       |  SELECT id,
    cliente_id,
    tipo,
    numero,
    numero_normalizado,
    whatsapp,
    principal,
    created_at,
    updated_at,
    deleted_at
   FROM core.telefones
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public     | v_audit_logs_recentes           |  SELECT al.id,
    al.action,
    al.table_name,
    al.record_id,
    al.user_id,
    al.user_email,
    u.nome_completo AS user_nome,
    u.role_code AS user_role,
    al.old_data,
    al.new_data,
    al.changes,
    al.ip_address,
    al.user_agent,
    al.request_id,
    al.loja_id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    al.created_at,
        CASE
            WHEN ((al.action)::text = 'INSERT'::text) THEN (('Criou '::text || (al.table_name)::text))::character varying
            WHEN ((al.action)::text = 'UPDATE'::text) THEN (('Atualizou '::text || (al.table_name)::text))::character varying
            WHEN ((al.action)::text = 'DELETE'::text) THEN (('Deletou '::text || (al.table_name)::text))::character varying
            WHEN ((al.action)::text = 'LOGIN'::text) THEN 'Fez login no sistema'::character varying
            WHEN ((al.action)::text = 'LOGOUT'::text) THEN 'Fez logout do sistema'::character varying
            WHEN ((al.action)::text = 'FAILED_LOGIN'::text) THEN 'Tentativa de login falhou'::character varying
            ELSE al.action
        END AS action_description
   FROM ((auth_sistema.audit_logs al
     LEFT JOIN auth_sistema.users u ON ((u.id = al.user_id)))
     LEFT JOIN core.lojas l ON ((l.id = al.loja_id)))
  ORDER BY al.created_at DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public     | v_despesas_caixa                |  SELECT id,
    sessao_caixa_id,
    loja_id,
    valor,
    (forma_pagamento)::text AS forma_pagamento,
    data_lancamento,
    (categoria)::text AS categoria,
    descricao,
    'DESPESA'::text AS tipo_movimento,
    created_at
   FROM vendas.despesas_operacionais d
  WHERE (data_lancamento IS NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | v_entregas_caixa                |  SELECT id,
    venda_id,
    loja_id,
    sessao_caixa_id,
    valor_entrega AS valor,
    'DINHEIRO'::text AS forma_pagamento,
    data_entrega,
    'ENTREGA_PAGAMENTO'::text AS tipo_movimento,
    created_at
   FROM pagamentos.entregas e
  WHERE ((valor_entrega > (0)::numeric) AND (data_entrega IS NOT NULL));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public     | v_movimentacoes_caixa           |  SELECT id,
    sessao_id AS sessao_caixa_id,
    tipo,
    valor,
    'DINHEIRO'::text AS forma_pagamento,
    descricao,
    created_at
   FROM fechamento_caixa.movimentacoes m
  WHERE (tipo = ANY (ARRAY['SANGRIA'::text, 'SUPRIMENTO'::text]));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public     | v_movimentacoes_financeiras_dia |  SELECT v_vendas_caixa_dia.venda_id AS origem_id,
    'vendas'::text AS origem_schema,
    'VENDA_ENTRADA'::text AS tipo,
    v_vendas_caixa_dia.loja_id,
    NULL::uuid AS sessao_caixa_id,
    v_vendas_caixa_dia.valor,
    v_vendas_caixa_dia.forma_pagamento,
    v_vendas_caixa_dia.data_venda AS data_movimento,
    v_vendas_caixa_dia.created_at
   FROM v_vendas_caixa_dia
UNION ALL
 SELECT v_pagamentos_adicionais_caixa.venda_id AS origem_id,
    'pagamentos'::text AS origem_schema,
    'VENDA_RESTANTE'::text AS tipo,
    v_pagamentos_adicionais_caixa.loja_id,
    v_pagamentos_adicionais_caixa.sessao_caixa_id,
    v_pagamentos_adicionais_caixa.valor,
    v_pagamentos_adicionais_caixa.forma_pagamento,
    (v_pagamentos_adicionais_caixa.data_pagamento)::date AS data_movimento,
    v_pagamentos_adicionais_caixa.created_at
   FROM v_pagamentos_adicionais_caixa
UNION ALL
 SELECT v_pagamentos_carnes_caixa.id AS origem_id,
    'pagamentos'::text AS origem_schema,
    'CARNE_PAGAMENTO'::text AS tipo,
    v_pagamentos_carnes_caixa.loja_id,
    NULL::uuid AS sessao_caixa_id,
    v_pagamentos_carnes_caixa.valor,
    v_pagamentos_carnes_caixa.forma_pagamento,
    v_pagamentos_carnes_caixa.data_pagamento AS data_movimento,
    v_pagamentos_carnes_caixa.created_at
   FROM v_pagamentos_carnes_caixa
UNION ALL
 SELECT v_entregas_caixa.venda_id AS origem_id,
    'pagamentos'::text AS origem_schema,
    'ENTREGA_PAGAMENTO'::text AS tipo,
    v_entregas_caixa.loja_id,
    v_entregas_caixa.sessao_caixa_id,
    v_entregas_caixa.valor,
    v_entregas_caixa.forma_pagamento,
    (v_entregas_caixa.data_entrega)::date AS data_movimento,
    v_entregas_caixa.created_at
   FROM v_entregas_caixa
UNION ALL
 SELECT v_despesas_caixa.id AS origem_id,
    'vendas'::text AS origem_schema,
    'DESPESA'::text AS tipo,
    v_despesas_caixa.loja_id,
    v_despesas_caixa.sessao_caixa_id,
    (- v_despesas_caixa.valor) AS valor,
    v_despesas_caixa.forma_pagamento,
    (v_despesas_caixa.data_lancamento)::date AS data_movimento,
    v_despesas_caixa.created_at
   FROM v_despesas_caixa
UNION ALL
 SELECT v_movimentacoes_caixa.id AS origem_id,
    'fechamento_caixa'::text AS origem_schema,
    'SANGRIA'::text AS tipo,
    NULL::uuid AS loja_id,
    v_movimentacoes_caixa.sessao_caixa_id,
    (- v_movimentacoes_caixa.valor) AS valor,
    v_movimentacoes_caixa.forma_pagamento,
    (v_movimentacoes_caixa.created_at)::date AS data_movimento,
    v_movimentacoes_caixa.created_at
   FROM v_movimentacoes_caixa
  WHERE (v_movimentacoes_caixa.tipo = 'SANGRIA'::text)
UNION ALL
 SELECT v_movimentacoes_caixa.id AS origem_id,
    'fechamento_caixa'::text AS origem_schema,
    'SUPRIMENTO'::text AS tipo,
    NULL::uuid AS loja_id,
    v_movimentacoes_caixa.sessao_caixa_id,
    v_movimentacoes_caixa.valor,
    v_movimentacoes_caixa.forma_pagamento,
    (v_movimentacoes_caixa.created_at)::date AS data_movimento,
    v_movimentacoes_caixa.created_at
   FROM v_movimentacoes_caixa
  WHERE (v_movimentacoes_caixa.tipo = 'SUPRIMENTO'::text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | v_pagamentos_adicionais_caixa   |  SELECT pa.id,
    pa.venda_id,
    pa.sessao_caixa_id,
    pa.valor_pago AS valor,
    (pa.forma_pagamento)::text AS forma_pagamento,
    pa.data_pagamento,
    'VENDA_RESTANTE'::text AS tipo_movimento,
    pa.created_at,
    v.loja_id
   FROM (pagamentos.pagamentos_adicionais pa
     JOIN vendas.vendas v ON ((v.id = pa.venda_id)))
  WHERE (pa.data_pagamento IS NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public     | v_pagamentos_carnes_caixa       |  SELECT id,
    cliente_uuid,
    loja_uuid AS loja_id,
    valor_parcela AS valor,
        CASE
            WHEN (plano_pagamento ~~* '%dinheiro%'::text) THEN 'DINHEIRO'::text
            WHEN ((plano_pagamento ~~* '%debito%'::text) OR (plano_pagamento ~~* '%débito%'::text)) THEN 'CARTAO_DEBITO'::text
            WHEN ((plano_pagamento ~~* '%credito%'::text) OR (plano_pagamento ~~* '%crédito%'::text)) THEN 'CARTAO_CREDITO'::text
            WHEN (plano_pagamento ~~* '%pix%'::text) THEN 'PIX'::text
            ELSE 'DINHEIRO'::text
        END AS forma_pagamento,
    data_pagamento,
    'CARNE_PAGAMENTO'::text AS tipo_movimento,
    created_at
   FROM pagamentos.entradas_carne ec
  WHERE (data_pagamento IS NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public     | v_parcelas_vencidas             |  SELECT parcela_id,
    venda_id,
    data_venda,
    cliente_nome,
    cliente_cpf,
    cliente_email,
    cliente_telefone,
    telefone_whatsapp,
    loja_nome,
    numero_parcela,
    valor_parcela,
    data_vencimento,
    dias_atraso,
    valor_total_financiamento
   FROM vendas.v_parcelas_vencidas;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public     | v_timeline_venda                |  SELECT venda_id,
    numero_venda,
    historico_id,
    status_anterior,
    status_novo,
    data_mudanca,
    observacao,
    origem,
    usuario_nome,
    usuario_email,
    data_status_anterior,
    segundos_no_status_anterior,
    cliente_nome,
    created_at
   FROM vendas.v_timeline_venda;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | v_user_lojas_acesso             |  SELECT ul.user_id,
    u.email,
    u.nome_completo,
    u.role_code,
    r.level AS role_level,
    ul.loja_id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    l.cidade AS loja_cidade,
    l.ativo AS loja_ativa,
    ul.is_primary,
    ul.can_manage,
    ul.custom_permissions,
    l.rede_id,
    re.nome AS rede_nome,
    ul.valid_from,
    ul.valid_until,
        CASE
            WHEN ((ul.valid_from IS NOT NULL) AND (ul.valid_from > CURRENT_DATE)) THEN false
            WHEN ((ul.valid_until IS NOT NULL) AND (ul.valid_until < CURRENT_DATE)) THEN false
            ELSE true
        END AS acesso_valido,
    ul.created_at
   FROM ((((auth_sistema.user_lojas ul
     JOIN auth_sistema.users u ON ((u.id = ul.user_id)))
     JOIN auth_sistema.roles r ON (((r.code)::text = (u.role_code)::text)))
     JOIN core.lojas l ON ((l.id = ul.loja_id)))
     LEFT JOIN auth_sistema.redes re ON ((re.id = l.rede_id)))
  WHERE (((u.status)::text = 'active'::text) AND (l.ativo = true) AND (l.deleted_at IS NULL));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public     | v_user_permissions              |  WITH role_permissions AS (
         SELECT u_1.id AS user_id,
            unnest(r.permissions) AS permission_code,
            'role'::text AS source,
            true AS granted,
            NULL::timestamp without time zone AS expires_at
           FROM (auth_sistema.users u_1
             JOIN auth_sistema.roles r ON (((r.code)::text = (u_1.role_code)::text)))
          WHERE ((u_1.status)::text = 'active'::text)
        ), user_overrides AS (
         SELECT up.user_id,
            up.permission_code,
            'override'::text AS source,
            up.granted,
            up.expires_at
           FROM auth_sistema.user_permissions up
          WHERE ((up.expires_at IS NULL) OR (up.expires_at > now()))
        ), all_permissions AS (
         SELECT role_permissions.user_id,
            role_permissions.permission_code,
            role_permissions.source,
            role_permissions.granted,
            role_permissions.expires_at
           FROM role_permissions
        UNION ALL
         SELECT user_overrides.user_id,
            user_overrides.permission_code,
            user_overrides.source,
            user_overrides.granted,
            user_overrides.expires_at
           FROM user_overrides
        ), final_permissions AS (
         SELECT DISTINCT ON (all_permissions.user_id, all_permissions.permission_code) all_permissions.user_id,
            all_permissions.permission_code,
            all_permissions.source,
            all_permissions.granted,
            all_permissions.expires_at
           FROM all_permissions
          ORDER BY all_permissions.user_id, all_permissions.permission_code,
                CASE all_permissions.source
                    WHEN 'override'::text THEN 1
                    ELSE 2
                END
        )
 SELECT fp.user_id,
    fp.permission_code,
    p.name AS permission_name,
    p.description AS permission_description,
    p.module,
    p.action,
    p.risk_level,
    fp.source,
    fp.granted,
    fp.expires_at,
    u.email,
    u.nome_completo,
    u.role_code
   FROM ((final_permissions fp
     JOIN auth_sistema.permissions p ON (((p.code)::text = fp.permission_code)))
     JOIN auth_sistema.users u ON ((u.id = fp.user_id)))
  WHERE ((fp.granted = true) AND (p.active = true));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | v_users_completo                |  SELECT u.id,
    u.email,
    u.nome_completo,
    u.apelido,
    u.cpf,
    u.telefone,
    u.avatar_url,
    u.status,
    u.email_verified,
    u.phone_verified,
    u.role_code,
    r.name AS role_name,
    r.level AS role_level,
    r.can_manage_users,
    r.can_view_all_stores,
    r.max_discount_percent,
    u.cargo_id,
    c.name AS cargo_name,
    c.description AS cargo_description,
    u.manager_id,
    m.nome_completo AS manager_nome,
    m.email AS manager_email,
    u.rede_id,
    re.nome AS rede_nome,
    ( SELECT l.id
           FROM (auth_sistema.user_lojas ul
             JOIN core.lojas l ON ((l.id = ul.loja_id)))
          WHERE ((ul.user_id = u.id) AND (ul.is_primary = true))
         LIMIT 1) AS loja_primary_id,
    ( SELECT l.nome
           FROM (auth_sistema.user_lojas ul
             JOIN core.lojas l ON ((l.id = ul.loja_id)))
          WHERE ((ul.user_id = u.id) AND (ul.is_primary = true))
         LIMIT 1) AS loja_primary_nome,
    ( SELECT count(*) AS count
           FROM auth_sistema.user_lojas ul
          WHERE (ul.user_id = u.id)) AS total_lojas_acesso,
    u.failed_login_count,
    u.blocked_until,
    u.ultimo_acesso,
    u.created_at,
    u.updated_at
   FROM ((((auth_sistema.users u
     JOIN auth_sistema.roles r ON (((r.code)::text = (u.role_code)::text)))
     LEFT JOIN auth_sistema.cargos c ON ((c.id = u.cargo_id)))
     LEFT JOIN auth_sistema.users m ON ((m.id = u.manager_id)))
     LEFT JOIN auth_sistema.redes re ON ((re.id = u.rede_id)))
  WHERE ((u.status)::text <> 'deleted'::text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | v_vendas_caixa_dia              |  SELECT v.id AS venda_id,
    v.loja_id,
    v.numero_venda,
    v.data_venda,
    vfp.forma_pagamento_id,
    fp.nome AS forma_pagamento,
    COALESCE(vfp.valor_entrada, vfp.valor) AS valor,
    'VENDA_ENTRADA'::text AS tipo_movimento,
    v.created_at
   FROM ((vendas.vendas v
     JOIN vendas.vendas_formas_pagamento vfp ON ((vfp.venda_id = v.id)))
     JOIN vendas.formas_pagamento fp ON ((fp.id = vfp.forma_pagamento_id)))
  WHERE ((v.cancelado = false) AND (v.deleted_at IS NULL));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | v_vendas_por_status             |  SELECT status_pos_venda,
    total_vendas,
    vendas_ultimos_7_dias,
    vendas_ultimos_30_dias,
    tempo_medio_dias,
    valor_total,
    valor_medio
   FROM vendas.v_vendas_por_status;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public     | vendas                          |  SELECT v.id,
    v.numero_venda,
    v.cliente_id,
    c.nome AS cliente_nome,
    c.cpf AS cliente_cpf,
    v.loja_id,
    l.nome AS loja_nome,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_restante,
    v.status,
    v.observacoes,
    v.created_by,
    u.nome_completo AS vendedor_nome,
    v.status_pos_venda,
    v.data_confirmacao,
    v.data_inicio_producao,
    v.data_produto_pronto,
    v.data_entrega,
    v.created_at,
    v.updated_at,
    ( SELECT count(*) AS count
           FROM vendas.itens_venda vi
          WHERE (vi.venda_id = v.id)) AS total_itens
   FROM (((vendas.vendas v
     LEFT JOIN clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.lojas l ON ((l.id = v.loja_id)))
     LEFT JOIN auth_sistema.users u ON ((u.id = (v.created_by)::uuid)))
  ORDER BY v.created_at DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | vendas_ativas                   |  SELECT id,
    numero_venda,
    loja_id,
    cliente_id,
    vendedor_id,
    data_venda,
    tipo_operacao,
    valor_total,
    valor_entrada,
    valor_restante,
    status,
    cancelado,
    created_at,
    updated_at
   FROM vendas.vendas
  WHERE ((deleted_at IS NULL) AND (cancelado = false));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public     | vendas_carne_entrada_pendente   |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    c.nome AS cliente_nome,
    vend.nome AS vendedor_nome,
    v.valor_total,
    v.valor_entrada_minimo AS entrada_minima,
    v.valor_entrada_pago AS entrada_paga,
    (v.valor_entrada_minimo - v.valor_entrada_pago) AS saldo_entrada,
    round(((v.valor_entrada_pago / v.valor_entrada_minimo) * (100)::numeric), 1) AS percentual_pago,
    v.entrada_completa,
    v.observacoes_pagamento,
    v.status AS status_venda,
        CASE
            WHEN v.entrada_completa THEN '✅ ENTRADA COMPLETA'::text
            WHEN (v.valor_entrada_pago = (0)::numeric) THEN '🔴 ENTRADA NÃO PAGA'::text
            ELSE '⚠️ ENTRADA PARCIAL'::text
        END AS alerta_entrada,
        CASE
            WHEN v.entrada_completa THEN 'Cliente pode retirar após vencimento das parcelas'::text
            WHEN (v.valor_entrada_pago = (0)::numeric) THEN 'Cliente ainda não pagou nenhum valor da entrada'::text
            ELSE 'Cliente precisa completar entrada antes da retirada'::text
        END AS orientacao
   FROM ((vendas.vendas v
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  WHERE ((v.valor_entrada_minimo IS NOT NULL) AND (v.valor_entrada_minimo > (0)::numeric) AND (v.entrada_completa = false) AND (v.status = 'ATIVO'::status_type))
  ORDER BY v.data_venda DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public     | vendas_detalhes                 |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    v.cliente_id,
    v.vendedor_id,
    v.loja_id,
    v.valor_total,
    v.valor_pago,
    (v.valor_total - v.valor_pago) AS saldo_pendente,
    v.status,
    v.status_financeiro,
    v.observacoes_pagamento,
    v.valor_entrada_minimo,
    v.valor_entrada_pago,
        CASE
            WHEN ((v.valor_entrada_minimo IS NOT NULL) AND (v.valor_entrada_minimo > (0)::numeric)) THEN (v.valor_entrada_minimo - v.valor_entrada_pago)
            ELSE NULL::numeric
        END AS saldo_entrada,
    v.entrada_completa,
    c.nome AS cliente_nome,
    vend.nome AS vendedor_nome,
    l.nome AS loja_nome,
    ( SELECT json_agg(json_build_object('forma_pagamento_id', vfp.forma_pagamento_id, 'nome_forma', fp.nome, 'valor', vfp.valor, 'parcelas', vfp.parcelas, 'modalidade', vfp.modalidade, 'status_pagamento', vfp.status_pagamento) ORDER BY vfp.created_at) AS json_agg
           FROM (vendas.vendas_formas_pagamento vfp
             LEFT JOIN vendas.formas_pagamento fp ON ((fp.id = vfp.forma_pagamento_id)))
          WHERE (vfp.venda_id = v.id)) AS formas_pagamento,
    ( SELECT json_agg(json_build_object('tipo_produto', vi.tipo_produto, 'descricao', vi.descricao, 'quantidade', vi.quantidade, 'valor_unitario', vi.valor_unitario, 'valor_total', ((vi.quantidade)::numeric * vi.valor_unitario))) AS json_agg
           FROM vendas.itens_venda vi
          WHERE (vi.venda_id = v.id)) AS itens,
    v.created_at,
    v.updated_at
   FROM (((vendas.vendas v
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
     LEFT JOIN core.lojas l ON ((l.id = v.loja_id)))
  ORDER BY v.data_venda DESC, v.numero_venda DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public     | vendas_dia                      |  SELECT id,
    numero_venda,
    cliente_id,
    loja_id,
    vendedor_id,
    data_venda,
    valor_total,
    valor_entrada,
    valor_restante,
    nome_cliente_temp,
    observacoes,
    status,
    cancelado,
    created_at,
    updated_at,
    tipo_operacao
   FROM vendas.vendas
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public     | vendas_formas_pagamento         |  SELECT id,
    venda_id,
    forma_pagamento_id,
    modalidade,
    valor_principal,
    numero_parcelas,
    taxa_juros_mensal,
    valor_parcela,
    total_juros,
    valor_total,
    forma_pagamento_entrada,
    created_at
   FROM vendas.vendas_formas_pagamento;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | vendas_itens                    |  SELECT id,
    venda_id,
    tipo_produto,
    descricao,
    quantidade,
    valor_unitario,
    valor_desconto,
    valor_total
   FROM vendas.itens_venda
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | vendas_saldo_pendente           |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    c.nome AS cliente_nome,
    vend.nome AS vendedor_nome,
    v.valor_total,
    v.valor_pago,
    (v.valor_total - v.valor_pago) AS saldo_pendente,
    v.status_financeiro,
    v.observacoes_pagamento,
    v.status AS status_venda,
        CASE
            WHEN ((v.status_financeiro)::text = 'PARCIAL'::text) THEN '⚠️ COBRAR NA ENTREGA'::text
            WHEN ((v.status_financeiro)::text = 'PENDENTE'::text) THEN '🔴 NADA PAGO'::text
            ELSE '✅ PAGO'::text
        END AS alerta
   FROM ((vendas.vendas v
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  WHERE (((v.status_financeiro)::text = ANY ((ARRAY['PARCIAL'::character varying, 'PENDENTE'::character varying])::text[])) AND (v.status = 'ATIVO'::status_type))
  ORDER BY v.data_venda DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public     | vw_clientes                     |  SELECT id,
    id_legado,
    nome,
    nome_normalizado,
    cpf,
    rg,
    data_nascimento,
    sexo,
    email,
    (status)::text AS status,
    origem,
    tags,
    observacoes,
    created_at,
    updated_at,
    ( SELECT count(*) AS count
           FROM core.telefones t
          WHERE ((t.cliente_id = c.id) AND (t.deleted_at IS NULL))) AS total_telefones,
    ( SELECT count(*) AS count
           FROM core.endereco_cliente e
          WHERE ((e.cliente_id = c.id) AND (e.deleted_at IS NULL))) AS total_enderecos,
    ( SELECT count(*) AS count
           FROM vendas.vendas v
          WHERE ((v.cliente_id = c.id) AND (v.deleted_at IS NULL) AND ((v.cancelado = false) OR (v.cancelado IS NULL)))) AS total_vendas,
    (0)::bigint AS total_os,
    ( SELECT COALESCE(sum(v.valor_total), (0)::numeric) AS "coalesce"
           FROM vendas.vendas v
          WHERE ((v.cliente_id = c.id) AND (v.deleted_at IS NULL) AND ((v.cancelado = false) OR (v.cancelado IS NULL)))) AS valor_total_vendas,
    ( SELECT COALESCE(sum(v.valor_restante), (0)::numeric) AS "coalesce"
           FROM vendas.vendas v
          WHERE ((v.cliente_id = c.id) AND (v.deleted_at IS NULL) AND ((v.cancelado = false) OR (v.cancelado IS NULL)))) AS saldo_devedor,
    NULL::text AS lead_origem,
    NULL::text AS lead_canal
   FROM core.clientes c
  WHERE (deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public     | vw_dashboard_lojas              |  SELECT l.id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    COALESCE(v.total_vendas, (0)::bigint) AS total_vendas,
    COALESCE(v.valor_vendas, (0)::numeric) AS valor_vendas,
    COALESCE(v.valor_entradas, (0)::numeric) AS valor_entradas,
    COALESCE(v.valor_restante, (0)::numeric) AS valor_restante,
    COALESCE(r.total_recebimentos, (0)::bigint) AS total_recebimentos,
    COALESCE(r.valor_recebimentos, (0)::numeric) AS valor_recebimentos,
    COALESCE(e.total_entregas, (0)::bigint) AS total_entregas,
    COALESCE(e.valor_entregas, (0)::numeric) AS valor_entregas,
    0 AS total_os,
    0 AS valor_os
   FROM (((core.lojas l
     LEFT JOIN ( SELECT vendas.loja_id,
            count(*) AS total_vendas,
            sum(vendas.valor_total) AS valor_vendas,
            sum(vendas.valor_entrada) AS valor_entradas,
            sum(vendas.valor_restante) AS valor_restante
           FROM vendas.vendas
          WHERE ((vendas.deleted_at IS NULL) AND ((vendas.cancelado = false) OR (vendas.cancelado IS NULL)))
          GROUP BY vendas.loja_id) v ON ((v.loja_id = l.id)))
     LEFT JOIN ( SELECT recebimentos_carne.loja_id,
            count(*) AS total_recebimentos,
            sum(recebimentos_carne.valor_parcela) AS valor_recebimentos
           FROM vendas.recebimentos_carne
          WHERE (recebimentos_carne.deleted_at IS NULL)
          GROUP BY recebimentos_carne.loja_id) r ON ((r.loja_id = l.id)))
     LEFT JOIN ( SELECT entregas_carne.loja_id,
            count(*) AS total_entregas,
            sum(entregas_carne.valor_total) AS valor_entregas
           FROM vendas.entregas_carne
          WHERE (entregas_carne.deleted_at IS NULL)
          GROUP BY entregas_carne.loja_id) e ON ((e.loja_id = l.id)))
  WHERE (l.deleted_at IS NULL)
  ORDER BY COALESCE(v.valor_vendas, (0)::numeric) DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public     | vw_dashboard_stats              |  SELECT ( SELECT count(*) AS count
           FROM core.clientes
          WHERE (clientes.deleted_at IS NULL)) AS total_clientes,
    ( SELECT count(*) AS count
           FROM core.clientes
          WHERE ((clientes.deleted_at IS NULL) AND (clientes.status = 'ATIVO'::status_type))) AS clientes_ativos,
    ( SELECT count(*) AS count
           FROM vendas.vendas
          WHERE ((vendas.deleted_at IS NULL) AND ((vendas.cancelado = false) OR (vendas.cancelado IS NULL)))) AS total_vendas,
    ( SELECT COALESCE(sum(vendas.valor_total), (0)::numeric) AS "coalesce"
           FROM vendas.vendas
          WHERE ((vendas.deleted_at IS NULL) AND ((vendas.cancelado = false) OR (vendas.cancelado IS NULL)))) AS valor_total_vendas,
    ( SELECT COALESCE(sum(vendas.valor_entrada), (0)::numeric) AS "coalesce"
           FROM vendas.vendas
          WHERE ((vendas.deleted_at IS NULL) AND ((vendas.cancelado = false) OR (vendas.cancelado IS NULL)))) AS valor_total_entradas,
    ( SELECT COALESCE(sum(vendas.valor_restante), (0)::numeric) AS "coalesce"
           FROM vendas.vendas
          WHERE ((vendas.deleted_at IS NULL) AND ((vendas.cancelado = false) OR (vendas.cancelado IS NULL)))) AS valor_total_restante,
    ( SELECT count(*) AS count
           FROM vendas.recebimentos_carne
          WHERE (recebimentos_carne.deleted_at IS NULL)) AS total_recebimentos,
    ( SELECT COALESCE(sum(recebimentos_carne.valor_parcela), (0)::numeric) AS "coalesce"
           FROM vendas.recebimentos_carne
          WHERE (recebimentos_carne.deleted_at IS NULL)) AS valor_recebimentos,
    ( SELECT count(*) AS count
           FROM vendas.entregas_carne
          WHERE (entregas_carne.deleted_at IS NULL)) AS total_entregas,
    ( SELECT COALESCE(sum(entregas_carne.valor_total), (0)::numeric) AS "coalesce"
           FROM vendas.entregas_carne
          WHERE (entregas_carne.deleted_at IS NULL)) AS valor_entregas,
    ( SELECT count(*) AS count
           FROM core.lojas
          WHERE (lojas.deleted_at IS NULL)) AS lojas_ativas,
    0 AS total_os,
    0 AS valor_total_os;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public     | vw_dashboard_ultimas_vendas     |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_restante,
    v.status,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    c.nome AS cliente_nome,
    c.cpf AS cliente_cpf,
    vend.nome AS vendedor_nome
   FROM (((vendas.vendas v
     JOIN core.lojas l ON ((l.id = v.loja_id)))
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  WHERE ((v.deleted_at IS NULL) AND ((v.cancelado = false) OR (v.cancelado IS NULL)))
  ORDER BY v.data_venda DESC, v.created_at DESC
 LIMIT 10;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public     | vw_entregas_calendario          |  SELECT p.id AS entrega_id,
    p.data_vencimento AS data_entrega,
    p.valor AS valor_entrega,
    p.numero_parcela AS parcela,
    NULL::text AS os_numero,
    NULL::text AS observacoes,
        CASE
            WHEN (p.data_vencimento < CURRENT_DATE) THEN 'VENCIDA'::text
            WHEN (p.data_vencimento = CURRENT_DATE) THEN 'HOJE'::text
            WHEN (p.data_vencimento > CURRENT_DATE) THEN 'FUTURA'::text
            ELSE NULL::text
        END AS status_temporal,
    (p.data_vencimento - CURRENT_DATE) AS dias_ate_vencimento,
    v.id AS venda_id,
    v.numero_venda,
    v.data_venda,
    v.valor_total AS valor_total_venda,
    v.valor_entrada,
    v.valor_restante,
    v.cliente_id,
    COALESCE(c.nome, v.nome_cliente_temp) AS cliente_nome,
    c.cpf AS cliente_cpf,
    c.email AS cliente_email,
    ( SELECT t.numero
           FROM core.telefones t
          WHERE ((t.cliente_id = c.id) AND (t.deleted_at IS NULL))
          ORDER BY t.principal DESC NULLS LAST
         LIMIT 1) AS cliente_telefone,
    v.loja_id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    l.cidade AS loja_cidade,
    v.vendedor_id,
    u.email AS vendedor_nome,
    ( SELECT count(*) AS count
           FROM vendas.parcelas p2
          WHERE (p2.venda_id = v.id)) AS total_parcelas_venda,
    p.numero_parcela AS numero_parcela_sequencial
   FROM ((((vendas.parcelas p
     JOIN vendas.vendas v ON ((v.id = p.venda_id)))
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.lojas l ON ((l.id = v.loja_id)))
     LEFT JOIN auth.users u ON ((u.id = v.vendedor_id)))
  WHERE ((v.deleted_at IS NULL) AND ((v.cancelado = false) OR (v.cancelado IS NULL)) AND (p.eh_entrada = false))
  ORDER BY p.data_vencimento DESC, p.created_at DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public     | vw_formas_pagamento             |  SELECT vfp.id,
    vfp.venda_id,
    vfp.forma_pagamento_id,
    fp.nome AS forma_pagamento_nome,
    fp.codigo AS forma_pagamento_codigo,
    fp.categoria AS forma_pagamento_categoria,
    vfp.modalidade,
    vfp.valor_principal,
    vfp.valor,
    vfp.valor_total,
    vfp.numero_parcelas,
    vfp.status_pagamento,
    vfp.created_at
   FROM (vendas.vendas_formas_pagamento vfp
     LEFT JOIN vendas.formas_pagamento fp ON ((fp.id = vfp.forma_pagamento_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | vw_parcelas                     |  SELECT p.id,
    p.venda_id,
    p.venda_forma_pagamento_id,
    p.numero_parcela,
    p.valor,
    p.data_vencimento,
    p.data_pagamento,
    p.status,
    p.eh_entrada,
    p.created_at,
    vfp.modalidade,
    fp.nome AS forma_pagamento_nome,
    fp.codigo AS forma_pagamento_codigo,
    fp.categoria AS forma_pagamento_categoria
   FROM ((vendas.parcelas p
     LEFT JOIN vendas.vendas_formas_pagamento vfp ON ((vfp.id = p.venda_forma_pagamento_id)))
     LEFT JOIN vendas.formas_pagamento fp ON ((fp.id = vfp.forma_pagamento_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | vw_performance_receitas         |  SELECT r.id,
    COALESCE(NULLIF(TRIM(BOTH FROM r.medico), ''::text), 'Venda Direta / Sem Médico'::text) AS nome_medico,
    COALESCE(r.data_receita, v.data_venda) AS data_ref,
    v.id AS venda_id,
    v.cliente_id,
    GREATEST(abs(COALESCE(r.od_esferico, (0)::numeric)), abs(COALESCE(r.oe_esferico, (0)::numeric))) AS max_esferico,
    GREATEST(abs(COALESCE(r.od_cilindrico, (0)::numeric)), abs(COALESCE(r.oe_cilindrico, (0)::numeric))) AS max_cilindrico
   FROM (vendas.receitas r
     LEFT JOIN vendas.vendas v ON ((v.id = r.venda_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public     | vw_performance_vendedores       |  SELECT v.vendedor_id,
    (COALESCE(cv.nome_exibicao, cv.nome, u.nome_completo, (('Vendedor '::text || "substring"((v.vendedor_id)::text, 1, 8)))::character varying))::text AS nome_final,
    COALESCE(u.avatar_url, ''::text) AS url_avatar,
    v.loja_id,
    v.data_venda,
    v.valor_total,
    count(i.id) AS total_itens,
    v.id AS venda_id
   FROM (((vendas.vendas v
     LEFT JOIN core.vendedores cv ON ((v.vendedor_id = cv.id)))
     LEFT JOIN auth_sistema.users u ON ((v.vendedor_id = u.id)))
     LEFT JOIN vendas.itens_venda i ON ((v.id = i.venda_id)))
  WHERE ((v.status)::text = ANY (ARRAY['ATIVO'::text, 'CONCLUIDO'::text, 'PAGO'::text]))
  GROUP BY v.vendedor_id, cv.nome_exibicao, cv.nome, u.nome_completo, u.avatar_url, v.loja_id, v.data_venda, v.valor_total, v.id;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public     | vw_produtos_mais_vendidos       |  SELECT iv.tipo_produto,
    iv.descricao,
    count(iv.id) AS quantidade_vendida,
    sum(iv.quantidade) AS total_unidades,
    sum(iv.valor_total) AS valor_total_vendido,
    avg(iv.valor_unitario) AS preco_medio,
    max(v.data_venda) AS ultima_venda
   FROM (vendas.itens_venda iv
     JOIN vendas.vendas v ON ((v.id = iv.venda_id)))
  WHERE ((v.cancelado = false) AND (v.data_venda >= (CURRENT_DATE - '90 days'::interval)))
  GROUP BY iv.tipo_produto, iv.descricao
  ORDER BY (count(iv.id)) DESC;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public     | vw_venda_detalhes               |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_restante,
    v.status,
    v.tipo_operacao,
    v.observacoes,
    v.cancelado,
    v.data_cancelamento,
    v.motivo_cancelamento,
    v.created_at,
    v.updated_at,
    jsonb_build_object('id', l.id, 'nome', l.nome, 'codigo', l.codigo) AS loja,
    jsonb_build_object('id', c.id, 'nome', c.nome, 'cpf', c.cpf, 'email', c.email) AS cliente,
    jsonb_build_object('id', vend.id, 'nome', vend.nome, 'email', vend.email) AS vendedor,
    ( SELECT COALESCE(json_agg(jsonb_build_object('id', vfp.id, 'forma_pagamento_id', vfp.forma_pagamento_id, 'forma_pagamento_nome', fp_ref.nome, 'forma_pagamento_codigo', fp_ref.codigo, 'forma_pagamento_categoria', fp_ref.categoria, 'modalidade', vfp.modalidade, 'valor_principal', vfp.valor_principal, 'valor', vfp.valor, 'valor_total', vfp.valor_total, 'numero_parcelas', vfp.numero_parcelas, 'taxa_juros_mensal', vfp.taxa_juros_mensal, 'valor_parcela', vfp.valor_parcela, 'total_juros', vfp.total_juros, 'status_pagamento', vfp.status_pagamento, 'created_at', vfp.created_at) ORDER BY vfp.created_at), '[]'::json) AS "coalesce"
           FROM (vendas.vendas_formas_pagamento vfp
             LEFT JOIN vendas.formas_pagamento fp_ref ON ((fp_ref.id = vfp.forma_pagamento_id)))
          WHERE (vfp.venda_id = v.id)) AS formas_pagamento,
    ( SELECT COALESCE(json_agg(jsonb_build_object('id', p.id, 'venda_forma_pagamento_id', p.venda_forma_pagamento_id, 'numero_parcela', p.numero_parcela, 'valor', p.valor, 'data_vencimento', p.data_vencimento, 'data_pagamento', p.data_pagamento, 'status', p.status, 'eh_entrada', p.eh_entrada, 'forma_pagamento_parcela', ( SELECT jsonb_build_object('nome', fp2.nome, 'codigo', fp2.codigo, 'categoria', fp2.categoria) AS jsonb_build_object
                   FROM (vendas.vendas_formas_pagamento vfp2
                     LEFT JOIN vendas.formas_pagamento fp2 ON ((fp2.id = vfp2.forma_pagamento_id)))
                  WHERE (vfp2.id = p.venda_forma_pagamento_id))) ORDER BY p.numero_parcela), '[]'::json) AS "coalesce"
           FROM vendas.parcelas p
          WHERE (p.venda_id = v.id)) AS parcelas,
    COALESCE(json_agg(DISTINCT jsonb_build_object('id', iv.id, 'tipo_produto', iv.tipo_produto, 'descricao', iv.descricao, 'quantidade', iv.quantidade, 'valor_unitario', iv.valor_unitario, 'valor_desconto', iv.valor_desconto, 'valor_total', iv.valor_total, 'observacoes', iv.observacoes, 'marca', iv.marca, 'modelo', iv.modelo, 'cor', iv.cor, 'tamanho', iv.tamanho, 'material', iv.material, 'codigo_produto', iv.codigo_produto, 'codigo_barras', iv.codigo_barras, 'fornecedor', iv.fornecedor, 'codigo_fornecedor', iv.codigo_fornecedor, 'produto_uuid', iv.produto_uuid, 'produto_sku_visual', iv.produto_sku_visual, 'produto_origem', iv.produto_origem, 'lente_uuid', iv.lente_uuid, 'lente_nome_normalizado', iv.lente_nome_normalizado, 'lente_fabricante', iv.lente_fabricante, 'lente_tipo', iv.lente_tipo, 'tratamento', iv.tratamento, 'grau_od', iv.grau_od, 'grau_oe', iv.grau_oe, 'adicao', iv.adicao, 'dnp_od', iv.dnp_od, 'dnp_oe', iv.dnp_oe, 'possui_estoque', iv.possui_estoque, 'requer_encomenda', iv.requer_encomenda, 'data_encomenda', iv.data_encomenda, 'data_prevista_chegada', iv.data_prevista_chegada)) FILTER (WHERE (iv.id IS NOT NULL)), '[]'::json) AS itens,
    COALESCE(json_agg(jsonb_build_object('id', rc.id, 'parcela_numero', rc.parcela_numero, 'parcela_total', rc.parcela_total, 'data_recebimento', rc.data_recebimento, 'valor_parcela', rc.valor_parcela, 'forma_pagamento', rc.forma_pagamento) ORDER BY rc.data_recebimento, rc.parcela_numero) FILTER (WHERE (rc.id IS NOT NULL)), '[]'::json) AS recebimentos,
    COALESCE(json_agg(jsonb_build_object('id', ec.id, 'data_entrega', ec.data_entrega, 'valor_total', ec.valor_total, 'parcela', ec.parcela, 'observacoes', ec.observacoes) ORDER BY ec.data_entrega) FILTER (WHERE (ec.id IS NOT NULL)), '[]'::json) AS entregas
   FROM ((((((vendas.vendas v
     JOIN core.lojas l ON ((l.id = v.loja_id)))
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
     LEFT JOIN vendas.itens_venda iv ON (((iv.venda_id = v.id) AND (iv.deleted_at IS NULL))))
     LEFT JOIN vendas.recebimentos_carne rc ON (((rc.venda_id = v.id) AND (rc.deleted_at IS NULL))))
     LEFT JOIN vendas.entregas_carne ec ON (((ec.venda_id = v.id) AND (ec.deleted_at IS NULL))))
  WHERE (v.deleted_at IS NULL)
  GROUP BY v.id, v.numero_venda, v.data_venda, v.valor_total, v.valor_entrada, v.valor_restante, v.status, v.tipo_operacao, v.observacoes, v.cancelado, v.data_cancelamento, v.motivo_cancelamento, v.created_at, v.updated_at, l.id, l.nome, l.codigo, c.id, c.nome, c.cpf, c.email, vend.id, vend.nome, vend.email; |
| public     | vw_vendas                       |  SELECT v.id,
    v.numero_venda,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_restante,
    v.status,
    v.cancelado,
    v.data_cancelamento,
    v.motivo_cancelamento,
    v.observacoes,
    v.tipo_operacao,
    v.is_garantia,
    NULL::text AS forma_pagamento,
    v.origem_venda,
    v.created_at,
    v.updated_at,
    v.nome_cliente_temp,
    v.cliente_id,
    COALESCE(c.nome, v.nome_cliente_temp) AS cliente_nome,
    c.cpf AS cliente_cpf,
    c.email AS cliente_email,
    v.loja_id,
    l.nome AS loja_nome,
    l.codigo AS loja_codigo,
    l.cidade AS loja_cidade,
    v.vendedor_id,
    vend.nome AS vendedor_nome,
    COALESCE(( SELECT json_agg(json_build_object('tipo_produto', i.tipo_produto, 'descricao', i.descricao, 'marca', i.marca, 'modelo', i.modelo, 'quantidade', i.quantidade, 'valor_unitario', i.valor_unitario, 'valor_desconto', COALESCE(i.valor_desconto, (0)::numeric), 'valor_total', i.valor_total)) AS json_agg
           FROM vendas.itens_venda i
          WHERE ((i.venda_id = v.id) AND (i.deleted_at IS NULL))), '[]'::json) AS itens,
    ( SELECT count(*) AS count
           FROM vendas.itens_venda i
          WHERE ((i.venda_id = v.id) AND (i.deleted_at IS NULL))) AS total_itens,
    ( SELECT sum(i.quantidade) AS sum
           FROM vendas.itens_venda i
          WHERE ((i.venda_id = v.id) AND (i.deleted_at IS NULL))) AS quantidade_total_itens,
    ( SELECT count(*) AS count
           FROM vendas.entregas_carne e
          WHERE ((e.venda_id = v.id) AND (e.deleted_at IS NULL))) AS total_entregas
   FROM (((vendas.vendas v
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.lojas l ON ((l.id = v.loja_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  WHERE (v.deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public     | vw_vendas_geral                 |  SELECT v.id,
    v.numero_venda,
    v.cliente_id,
    v.loja_id,
    v.vendedor_id,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_restante,
    v.nome_cliente_temp,
    v.observacoes,
    v.status,
    v.cancelado,
    v.data_cancelamento,
    v.motivo_cancelamento,
    v.created_at,
    v.updated_at,
    v.created_by,
    v.updated_by,
    v.deleted_at,
    v.version,
    v.tipo_operacao,
    v.is_garantia,
    v.origem_venda,
    v.utm_source,
    v.utm_medium,
    v.utm_campaign,
    v.utm_content,
    v.campanha_id,
    v.numero_venda_backup,
    v.numero_venda_int,
    l.nome AS loja_nome
   FROM (vendas.vendas v
     LEFT JOIN core.lojas l ON ((v.loja_id = l.id)))
  WHERE (v.deleted_at IS NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| vault      | decrypted_secrets               | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vendas     | v_autorizacoes_monitor          |  SELECT a.id,
    a.loja_id,
    l.nome AS loja_nome,
    a.vendedor_id,
    COALESCE(v.nome, 'Vendedor não IDentificado'::character varying) AS vendedor_nome,
    a.cliente_id,
    c.nome AS cliente_nome,
    a.tipo,
    a.status,
    a.valor_original,
    a.valor_solicitado,
    a.percentual_aplicado,
    a.justificativa,
    a.created_at,
    (EXTRACT(epoch FROM (now() - (a.created_at)::timestamp with time zone)) / (60)::numeric) AS minutos_espera
   FROM (((vendas.autorizacoes a
     LEFT JOIN core.lojas l ON ((l.id = a.loja_id)))
     LEFT JOIN core.vendedores v ON (((v.user_id = a.vendedor_id) OR (v.id = a.vendedor_id))))
     LEFT JOIN core.clientes c ON ((c.id = a.cliente_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas     | v_carnes_com_status             |  SELECT v.id AS venda_id,
    v.numero_venda,
    v.data_venda,
    v.valor_total,
    v.status_carne,
    c.nome AS cliente_nome,
    c.cpf AS cliente_cpf,
    u.nome_completo AS vendedor_nome,
    count(p.id) AS total_parcelas,
    count(p.id) FILTER (WHERE (((p.status)::text = 'PAGO'::text) OR (p.data_pagamento IS NOT NULL))) AS parcelas_pagas,
    count(p.id) FILTER (WHERE ((p.status)::text = 'PENDENTE'::text)) AS parcelas_pendentes,
    count(p.id) FILTER (WHERE ((p.status)::text = 'VENCIDO'::text)) AS parcelas_atrasadas,
    COALESCE(sum(p.valor), (0)::numeric) AS valor_total_parcelas,
    COALESCE(sum(
        CASE
            WHEN (((p.status)::text = 'PAGO'::text) OR (p.data_pagamento IS NOT NULL)) THEN p.valor
            ELSE (0)::numeric
        END), (0)::numeric) AS valor_total_pago,
    COALESCE(sum(
        CASE
            WHEN (((p.status)::text <> ALL ((ARRAY['PAGO'::character varying, 'CANCELADO'::character varying])::text[])) AND (p.data_pagamento IS NULL)) THEN p.valor
            ELSE (0)::numeric
        END), (0)::numeric) AS saldo_devedor,
    min(p.data_vencimento) FILTER (WHERE ((p.status)::text = ANY ((ARRAY['PENDENTE'::character varying, 'VENCIDO'::character varying])::text[]))) AS proxima_parcela_vencimento,
        CASE
            WHEN (count(p.id) = 0) THEN v.status_carne
            WHEN (count(p.id) = count(p.id) FILTER (WHERE ((p.status)::text = 'PAGO'::text))) THEN 'QUITADO'::status_carne_type
            WHEN (count(p.id) FILTER (WHERE ((p.status)::text = 'VENCIDO'::text)) > 0) THEN 'EM_ATRASO'::status_carne_type
            ELSE 'ATIVO'::status_carne_type
        END AS status_calculado,
    v.created_at,
    v.updated_at
   FROM (((vendas.vendas v
     JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN auth_sistema.users u ON ((u.id = v.vendedor_id)))
     LEFT JOIN vendas.parcelas p ON ((p.venda_id = v.id)))
  WHERE (v.status_carne IS NOT NULL)
  GROUP BY v.id, v.numero_venda, v.data_venda, v.valor_total, v.status_carne, c.nome, c.cpf, u.nome_completo, v.created_at, v.updated_at;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vendas     | v_parcelas_com_pagamentos       |  SELECT p.id,
    p.venda_id,
    p.numero_parcela,
    p.data_vencimento,
    p.valor,
    p.data_pagamento,
    p.status,
    p.eh_entrada,
    COALESCE(json_agg(json_build_object('pagamento_id', pg.id, 'valor', pg.valor, 'data_pagamento', pg.data_pagamento, 'forma_pagamento', fp.nome) ORDER BY pg.data_pagamento) FILTER (WHERE (pg.id IS NOT NULL)), '[]'::json) AS pagamentos_vinculados,
    COALESCE(sum(pg.valor), (0)::numeric) AS total_pago_vinculado,
        CASE
            WHEN ((p.status)::text = 'CANCELADO'::text) THEN 'CANCELADO'::text
            WHEN (((p.status)::text = 'PAGO'::text) OR (p.data_pagamento IS NOT NULL)) THEN 'PAGO'::text
            WHEN (p.data_vencimento < CURRENT_DATE) THEN 'VENCIDO'::text
            ELSE 'PENDENTE'::text
        END AS status_calculado
   FROM ((vendas.parcelas p
     LEFT JOIN vendas.pagamentos pg ON ((pg.parcela_id = p.id)))
     LEFT JOIN vendas.formas_pagamento fp ON ((fp.id = pg.forma_pagamento_id)))
  GROUP BY p.id, p.venda_id, p.numero_parcela, p.data_vencimento, p.valor, p.data_pagamento, p.status, p.eh_entrada;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vendas     | v_parcelas_vencidas             |  SELECT p.id AS parcela_id,
    v.id AS venda_id,
    v.data_venda,
    c.nome AS cliente_nome,
    c.cpf AS cliente_cpf,
    c.email AS cliente_email,
    t.numero AS cliente_telefone,
    t.whatsapp AS telefone_whatsapp,
    l.nome AS loja_nome,
    p.numero_parcela,
    p.valor AS valor_parcela,
    p.data_vencimento,
    (CURRENT_DATE - p.data_vencimento) AS dias_atraso,
    vfp.valor_total AS valor_total_financiamento
   FROM (((((vendas.parcelas p
     JOIN vendas.vendas v ON ((p.venda_id = v.id)))
     JOIN core.clientes c ON ((v.cliente_id = c.id)))
     JOIN core.lojas l ON ((v.loja_id = l.id)))
     JOIN vendas.vendas_formas_pagamento vfp ON ((v.id = vfp.venda_id)))
     LEFT JOIN LATERAL ( SELECT telefones.numero,
            telefones.whatsapp
           FROM core.telefones
          WHERE ((telefones.cliente_id = c.id) AND (telefones.ativo = true) AND (telefones.deleted_at IS NULL))
          ORDER BY telefones.principal DESC, telefones.whatsapp DESC
         LIMIT 1) t ON (true))
  WHERE (((p.status)::text = 'PENDENTE'::text) AND (p.data_vencimento < CURRENT_DATE) AND ((vfp.modalidade)::text = 'CARNE'::text))
  ORDER BY p.data_vencimento;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vendas     | v_timeline_venda                |  SELECT h.venda_id,
    v.numero_venda,
    h.id AS historico_id,
    h.status_anterior,
    h.status_novo,
    h.data_mudanca,
    h.observacao,
    h.origem,
    u.nome_completo AS usuario_nome,
    u.email AS usuario_email,
    lag(h.data_mudanca) OVER (PARTITION BY h.venda_id ORDER BY h.data_mudanca) AS data_status_anterior,
    (EXTRACT(epoch FROM (h.data_mudanca - lag(h.data_mudanca) OVER (PARTITION BY h.venda_id ORDER BY h.data_mudanca))))::integer AS segundos_no_status_anterior,
    c.nome AS cliente_nome,
    h.created_at
   FROM (((vendas.historico_status h
     JOIN vendas.vendas v ON ((v.id = h.venda_id)))
     JOIN clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN auth_sistema.users u ON ((u.id = h.usuario_id)))
  ORDER BY h.venda_id, h.data_mudanca;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas     | v_vendas_por_status             |  SELECT status_pos_venda,
    count(*) AS total_vendas,
    count(*) FILTER (WHERE (data_venda >= (CURRENT_DATE - '7 days'::interval))) AS vendas_ultimos_7_dias,
    count(*) FILTER (WHERE (data_venda >= (CURRENT_DATE - '30 days'::interval))) AS vendas_ultimos_30_dias,
    avg(
        CASE status_pos_venda
            WHEN 'PRODUCAO'::status_pos_venda_type THEN (EXTRACT(epoch FROM (COALESCE((data_produto_pronto)::timestamp with time zone, now()) - (data_inicio_producao)::timestamp with time zone)) / (86400)::numeric)
            WHEN 'PRONTO'::status_pos_venda_type THEN (EXTRACT(epoch FROM (COALESCE((data_entrega)::timestamp with time zone, now()) - (data_produto_pronto)::timestamp with time zone)) / (86400)::numeric)
            ELSE NULL::numeric
        END) AS tempo_medio_dias,
    sum(valor_total) AS valor_total,
    avg(valor_total) AS valor_medio
   FROM vendas.vendas v
  WHERE (status_pos_venda IS NOT NULL)
  GROUP BY status_pos_venda
  ORDER BY
        CASE status_pos_venda
            WHEN 'CONFIRMADO'::status_pos_venda_type THEN 1
            WHEN 'PRODUCAO'::status_pos_venda_type THEN 2
            WHEN 'PRONTO'::status_pos_venda_type THEN 3
            WHEN 'ENTREGUE'::status_pos_venda_type THEN 4
            WHEN 'CANCELADO'::status_pos_venda_type THEN 5
            ELSE NULL::integer
        END;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vendas     | vw_vendas_aguardando_entrada    |  SELECT v.id,
    v.numero_venda,
    v.cliente_id,
    v.data_venda,
    v.valor_total,
    v.valor_entrada,
    v.valor_minimo_entrada,
    v.data_limite_entrada,
    v.status_pagamento,
    (CURRENT_DATE - v.data_venda) AS dias_desde_venda,
    ((v.data_limite_entrada)::date - CURRENT_DATE) AS dias_restantes,
        CASE
            WHEN (CURRENT_DATE >= (v.data_limite_entrada)::date) THEN 'VENCIDO'::text
            WHEN (CURRENT_DATE >= ((v.data_limite_entrada)::date - '1 day'::interval)) THEN 'CRITICO'::text
            WHEN (CURRENT_DATE >= ((v.data_limite_entrada)::date - '3 days'::interval)) THEN 'URGENTE'::text
            ELSE 'NORMAL'::text
        END AS urgencia,
    c.nome AS cliente_nome,
    ( SELECT t.numero
           FROM core.telefones t
          WHERE ((t.cliente_id = v.cliente_id) AND (t.deleted_at IS NULL) AND (t.ativo = true))
          ORDER BY t.principal DESC NULLS LAST, t.created_at
         LIMIT 1) AS cliente_telefone,
    c.email AS cliente_email,
    vend.nome AS vendedor_nome
   FROM ((vendas.vendas v
     LEFT JOIN core.clientes c ON ((c.id = v.cliente_id)))
     LEFT JOIN core.vendedores vend ON ((vend.id = v.vendedor_id)))
  WHERE (((v.status_pagamento)::text = 'AGUARDANDO_ENTRADA'::text) AND (v.entrada_obrigatoria = true) AND (v.status = ANY (ARRAY['ATIVO'::status_type, 'PENDENTE'::status_type])));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |


-- Functions/Stored Procedures
SELECT 
    n.nspname as schema,
    p.proname as function_nome,
    pg_get_function_arguments(p.oid) as parametros,
    pg_get_function_result(p.oid) as retorno
FROM pg_proc p
JOIN pg_namespace n ON p.pronamespace = n.oid
WHERE n.nspname NOT IN ('pg_catalog', 'information_schema')
ORDER BY n.nspname, p.proname;

| schema             | function_nome                             | parametros                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | retorno                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------------------ | ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auditoria          | buscar_historico_registro                 | p_schema character varying, p_tabela character varying, p_registro_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | TABLE(data_alteracao timestamp without time zone, operacao character varying, usuario_nome character varying, campos_alterados text[], dados_antigos jsonb, dados_novos jsonb)                                                                                                                                                                                                                                                                                                                                                |
| auditoria          | gerar_snapshot_diario                     | p_data_snapshot date DEFAULT CURRENT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auditoria          | registrar_log                             | p_schema character varying, p_tabela character varying, p_registro_id uuid, p_operacao character varying, p_dados_antigos jsonb, p_dados_novos jsonb, p_observacoes text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth               | email                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth               | jwt                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| auth               | role                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth               | uid                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth_sistema       | can_view_user                             | target_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth_sistema       | get_user_role_level                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth_sistema       | increment_failed_login                    | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth_sistema       | log_user_action                           | p_user_id uuid, p_action character varying, p_table_name character varying DEFAULT NULL::character varying, p_record_id uuid DEFAULT NULL::uuid, p_old_data jsonb DEFAULT NULL::jsonb, p_new_data jsonb DEFAULT NULL::jsonb, p_ip_address inet DEFAULT NULL::inet, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| auth_sistema       | reset_failed_login_count                  | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth_sistema       | update_updated_at_column                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth_sistema       | validate_user_status                      | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(is_valid boolean, reason text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| carnes             | atualizar_updated_at_taxas                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | buscar_historico_consultas                | p_documento character varying, p_limite integer DEFAULT 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | TABLE(id uuid, tipo_consulta character varying, api_utilizada character varying, nome_encontrado text, situacao_cadastral character varying, score_credito integer, restricoes jsonb, consultado_em timestamp without time zone, usuario_nome character varying, motivo text)                                                                                                                                                                                                                                                 |
| carnes             | buscar_taxa_aplicavel                     | p_valor_carne numeric, p_parcelas integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | TABLE(id uuid, nome_configuracao character varying, taxa_mensal numeric, taxa_anual numeric, sistema_amortizacao sistema_amortizacao_type, cet_mensal numeric, cet_anual numeric)                                                                                                                                                                                                                                                                                                                                             |
| carnes             | calcular_parcela_sac                      | p_valor_principal numeric, p_taxa_mensal numeric, p_numero_parcelas integer, p_parcela_numero integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | calcular_parcelas_price                   | p_valor_principal numeric, p_taxa_mensal numeric, p_numero_parcelas integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | estatisticas_usuario                      | p_usuario_id uuid, p_data_inicio date DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim date DEFAULT CURRENT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | TABLE(total_consultas bigint, consultas_sucesso bigint, consultas_falha bigint, custo_total numeric, tempo_medio_ms numeric, apis_utilizadas jsonb)                                                                                                                                                                                                                                                                                                                                                                           |
| carnes             | garantir_unica_taxa_padrao                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | incrementar_uso_api                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | simular_carne                             | p_valor_principal numeric, p_numero_parcelas integer, p_data_primeira_parcela date DEFAULT NULL::date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TABLE(parcela_numero integer, data_vencimento date, valor_parcela numeric, valor_juros numeric, valor_amortizacao numeric, saldo_devedor numeric, sistema_amortizacao sistema_amortizacao_type, taxa_mensal numeric)                                                                                                                                                                                                                                                                                                          |
| carnes             | update_updated_at_column                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| carnes             | verificar_cache_consulta                  | p_documento character varying, p_tipo_consulta character varying, p_dias_validade integer DEFAULT 30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | TABLE(encontrado boolean, consulta_id uuid, dados jsonb, idade_dias integer)                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| carnes             | verificar_limite_api                      | p_api_nome character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | TABLE(pode_consultar boolean, consultas_hoje integer, limite_diario integer, consultas_mes integer, limite_mensal integer, mensagem text)                                                                                                                                                                                                                                                                                                                                                                                     |
| core               | adicionar_vendedor_loja                   | p_vendedor_id uuid, p_loja_id uuid, p_codigo_sistema character varying DEFAULT NULL::character varying, p_observacoes text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| core               | buscar_vendedor_por_nome                  | nome_busca text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| core               | get_user_loja_id                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| core               | normaliza_cep                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| core               | normaliza_cpf                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| core               | user_belongs_to_loja                      | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| core               | user_has_role                             | p_role character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| core               | user_is_admin_or_manager                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| cron               | alter_job                                 | job_id bigint, schedule text DEFAULT NULL::text, command text DEFAULT NULL::text, database text DEFAULT NULL::text, username text DEFAULT NULL::text, active boolean DEFAULT NULL::boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| cron               | job_cache_invalidate                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| cron               | schedule                                  | schedule text, command text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| cron               | schedule                                  | job_name text, schedule text, command text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| cron               | schedule_in_database                      | job_name text, schedule text, command text, database text, username text DEFAULT NULL::text, active boolean DEFAULT true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| cron               | unschedule                                | job_id bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| cron               | unschedule                                | job_name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| descontos          | aplicar_desconto                          | p_venda_id uuid, p_item_venda_id uuid, p_usuario_id uuid, p_cargo_id uuid, p_tipo_desconto character varying, p_valor_desconto numeric, p_valor_original numeric, p_motivo text, p_categoria_motivo character varying DEFAULT 'OUTRO'::character varying, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| descontos          | validar_desconto_usuario                  | p_cargo_id uuid, p_tipo_desconto character varying, p_valor_desconto numeric, p_valor_original numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| descontos          | validar_desconto_usuario                  | p_cargo_id uuid, p_tipo_desconto character varying, p_valor_desconto numeric, p_valor_original numeric, p_tipo_produto character varying DEFAULT 'GERAL'::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | armor                                     | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | armor                                     | bytea, text[], text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | crypt                                     | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | dearmor                                   | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | decrypt                                   | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | decrypt_iv                                | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | digest                                    | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | digest                                    | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | encrypt                                   | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | encrypt_iv                                | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | gen_random_bytes                          | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | gen_random_uuid                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | gen_salt                                  | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | gen_salt                                  | text, integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | grant_pg_cron_access                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | grant_pg_graphql_access                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | grant_pg_net_access                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | hmac                                      | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | hmac                                      | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pg_stat_statements                        | showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone | SETOF record                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions         | pg_stat_statements_info                   | OUT dealloc bigint, OUT stats_reset timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | record                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions         | pg_stat_statements_reset                  | userid oid DEFAULT 0, dbid oid DEFAULT 0, queryid bigint DEFAULT 0, minmax_only boolean DEFAULT false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| extensions         | pgp_armor_headers                         | text, OUT key text, OUT value text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | SETOF record                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions         | pgp_key_id                                | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_pub_decrypt                           | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_pub_decrypt                           | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_pub_decrypt                           | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_pub_decrypt_bytea                     | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_decrypt_bytea                     | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_decrypt_bytea                     | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_encrypt                           | text, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_encrypt                           | text, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_encrypt_bytea                     | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_pub_encrypt_bytea                     | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_decrypt                           | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_sym_decrypt                           | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | pgp_sym_decrypt_bytea                     | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_decrypt_bytea                     | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_encrypt                           | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_encrypt                           | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_encrypt_bytea                     | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgp_sym_encrypt_bytea                     | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions         | pgrst_ddl_watch                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | pgrst_drop_watch                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | set_graphql_placeholder                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions         | uuid_generate_v1                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_generate_v1mc                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_generate_v3                          | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_generate_v4                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_generate_v5                          | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_nil                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_ns_dns                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_ns_oid                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_ns_url                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions         | uuid_ns_x500                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| graphql            | _internal_resolve                         | query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| graphql            | comment_directive                         | comment_ text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| graphql            | exception                                 | message text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| graphql            | get_schema_version                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| graphql            | increment_schema_version                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| graphql            | resolve                                   | query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| graphql_public     | graphql                                   | "operationName" text DEFAULT NULL::text, query text DEFAULT NULL::text, variables jsonb DEFAULT NULL::jsonb, extensions jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| marketing          | atualizar_cliente_info_conversao          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| marketing          | atualizar_estatisticas_cliente            | p_cliente_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| marketing          | criar_cliente_com_marketing               | p_nome text, p_cpf text, p_canal_aquisicao_id uuid, p_rg text DEFAULT NULL::text, p_email text DEFAULT NULL::text, p_data_nascimento date DEFAULT NULL::date, p_sexo character DEFAULT 'O'::bpchar, p_observacoes text DEFAULT NULL::text, p_telefones jsonb DEFAULT '[]'::jsonb, p_endereco jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| marketing          | criar_cliente_teste_aniversario           | p_nome text, p_email text, p_cpf text, p_data_nascimento date, p_telefone text, p_segmento text DEFAULT 'BRONZE'::text, p_total_compras integer DEFAULT 0, p_valor_total numeric DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| marketing          | executar_matching_inteligente             | tendencia_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| marketing          | get_canais_por_categoria                  | p_categoria character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | TABLE(id uuid, codigo character varying, nome character varying, descricao text, categoria character varying)                                                                                                                                                                                                                                                                                                                                                                                                                 |
| marketing          | increment_landing_conversoes              | landing_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| marketing          | increment_landing_views                   | landing_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| marketing          | normalizar_como_conheceu                  | texto_bruto text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| marketing          | processar_campanha_orcamento              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(campanha_id uuid, leads_processados integer, envios_agendados integer, proxima_execucao_retorno timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                               |
| marketing          | registrar_conversao_orcamento             | p_orcamento_id uuid, p_venda_id uuid, p_cliente_id uuid, p_canal_codigo character varying, p_campanha_id uuid DEFAULT NULL::uuid, p_indicado_por character varying DEFAULT NULL::character varying, p_observacoes text DEFAULT NULL::text, p_utm_source character varying DEFAULT NULL::character varying, p_utm_medium character varying DEFAULT NULL::character varying, p_utm_campaign character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| marketing          | trigger_update_timestamp                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| marketing          | update_landing_pages_updated_at           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| net                | _await_response                           | request_id bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| net                | _encode_url_with_params_array             | url text, params_array text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| net                | _http_collect_response                    | request_id bigint, async boolean DEFAULT true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | net.http_response_result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| net                | _urlencode_string                         | string character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| net                | check_worker_is_up                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| net                | http_collect_response                     | request_id bigint, async boolean DEFAULT true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | net.http_response_result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| net                | http_delete                               | url text, params jsonb DEFAULT '{}'::jsonb, headers jsonb DEFAULT '{}'::jsonb, timeout_milliseconds integer DEFAULT 5000, body jsonb DEFAULT NULL::jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| net                | http_get                                  | url text, params jsonb DEFAULT '{}'::jsonb, headers jsonb DEFAULT '{}'::jsonb, timeout_milliseconds integer DEFAULT 5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| net                | http_post                                 | url text, body jsonb DEFAULT '{}'::jsonb, params jsonb DEFAULT '{}'::jsonb, headers jsonb DEFAULT '{"Content-Type": "application/json"}'::jsonb, timeout_milliseconds integer DEFAULT 5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bigint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| net                | wait_until_running                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| net                | wake                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| net                | worker_restart                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| pagamentos         | atualizar_resumo_entrada                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| pagamentos         | atualizar_valor_restante_venda            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| pagamentos         | calcular_score_cliente_carne              | cliente_uuid_param uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| pgbouncer          | get_auth                                  | p_usename text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(username text, password text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public             | alterar_cargo_colaborador                 | p_id uuid, p_novo_cargo text, p_origem text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | analise_abc_clientes                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(cliente_id uuid, cliente_nome character varying, total_gasto numeric, percentual_individual numeric, percentual_acumulado numeric, classificacao character varying, descricao_classe text)                                                                                                                                                                                                                                                                                                                              |
| public             | ativar_desativar_usuario                  | p_user_id uuid, p_ativo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | atualizar_colaborador_admin               | p_id text, p_nome text, p_email text, p_telefone text, p_cpf text, p_cargo text, p_loja_id text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | atualizar_profissional_admin              | p_id text, p_nome text, p_email text, p_telefone text, p_celular text, p_registro text, p_registro_uf text, p_registro_validade date, p_especialidades text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | atualizar_status_pos_venda                | p_venda_id uuid, p_novo_status status_pos_venda_type, p_observacao text DEFAULT NULL::text, p_sku_brinde text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | atualizar_updated_at                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | atualizar_updated_at_simples              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | buscar_historico_cliente                  | p_cliente_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(total_compras bigint, ultima_compra timestamp with time zone, ticket_medio numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public             | buscar_profissional_por_registro          | p_tipo_registro character varying, p_numero_registro character varying, p_uf character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(id uuid, nome character varying, tipo_profissional character varying, registro_formatado text, telefone character varying, celular character varying, email character varying, status character varying, registro_valido boolean)                                                                                                                                                                                                                                                                                       |
| public             | buscar_ultima_receita_cliente             | p_cliente_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | cadastrar_colaborador_simples             | p_nome text, p_email text DEFAULT NULL::text, p_telefone text DEFAULT NULL::text, p_cpf text DEFAULT NULL::text, p_loja_id uuid DEFAULT NULL::uuid, p_cargo text DEFAULT 'Vendedor'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | cadastrar_loja_simples                    | p_nome text, p_codigo text DEFAULT NULL::text, p_endereco text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | cadastrar_profissional_saude              | p_nome character varying, p_tipo_profissional character varying, p_registro character varying DEFAULT NULL::character varying, p_uf character varying DEFAULT NULL::character varying, p_telefone character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | TABLE(id uuid, nome character varying, tipo_profissional character varying, registro_formatado text, success boolean, message text)                                                                                                                                                                                                                                                                                                                                                                                           |
| public             | calcular_idade                            | data_nascimento date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | calcular_ltv_cliente                      | p_cliente_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(cliente_id uuid, cliente_nome character varying, primeira_compra date, ultima_compra date, meses_ativo integer, total_compras bigint, valor_total_gasto numeric, ticket_medio numeric, frequencia_compra_meses numeric, ltv_12_meses numeric, ltv_24_meses numeric, ltv_projetado numeric)                                                                                                                                                                                                                              |
| public             | can_user_login                            | user_email text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | cancelar_carne                            | p_venda_id uuid, p_motivo text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | check_permission                          | user_uuid uuid, perm_code character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | check_user_loja_access                    | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | consultar_historico_venda                 | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(historico_id uuid, status_anterior text, status_novo text, data_mudanca timestamp without time zone, tempo_no_status_anterior integer, usuario_nome text, observacao text, origem text)                                                                                                                                                                                                                                                                                                                                 |
| public             | converter_venda_para_carne                | p_venda_id uuid, p_numero_parcelas integer, p_formas_pagamento_entrada text, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | criar_carne_automatico                    | p_venda_id uuid, p_loja_id uuid, p_os_numero character varying, p_valor_total numeric, p_qtd_parcelas integer, p_data_primeira_parcela date DEFAULT CURRENT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | criar_cliente_info_automaticamente        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | definir_responsavel_tecnico               | p_profissional_id uuid, p_loja_id uuid, p_is_rt boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | finalizar_venda_carne                     | p_loja_id uuid, p_cliente_id uuid, p_vendedor_id uuid, p_valor_total numeric, p_itens jsonb, p_valor_entrada numeric, p_forma_pagamento_entrada_id uuid, p_forma_pagamento_entrada_nome character varying, p_valor_financiado numeric, p_numero_parcelas integer, p_valor_parcela numeric, p_taxa_juros_mensal numeric, p_total_juros numeric, p_total_com_juros numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | TABLE(venda_id uuid, numero_venda character varying, success boolean, message text)                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public             | fn_delete_vendas_formas_pagamento         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_clientes_proxy                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_contratos_carne                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_endereco_cliente_proxy          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_itens_venda_proxy               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_receitas_proxy                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_telefones_proxy                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_vendas                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_vendas_formas_pagamento         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_vendas_itens                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_insert_vendas_proxy                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | fn_update_vendas_formas_pagamento         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | formatar_cpf                              | cpf text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | gerar_codigo_sequencial                   | prefixo text, loja_codigo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | gerar_numero_contrato                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | gerar_parcelas_carne                      | p_venda_id uuid, p_numero_parcelas integer, p_valor_parcela numeric, p_forma_pagamento_entrada character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | get_advanced_insights                     | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(id text, title text, description text, type text, icon text, impact text, value text, trend text, action text, clients integer)                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_analytics_kpis                        | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_carnes_kpis                           | p_search_term text DEFAULT NULL::text, p_loja_id uuid DEFAULT NULL::uuid, p_status_temporal text DEFAULT NULL::text, p_valor_min numeric DEFAULT NULL::numeric, p_valor_max numeric DEFAULT NULL::numeric, p_dias_min integer DEFAULT NULL::integer, p_dias_max integer DEFAULT NULL::integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | TABLE(total_carnes bigint, valor_total numeric, proximas_entregas bigint, atrasadas bigint)                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_churn_risk_matrix                     | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(segment text, count bigint, risk text, value numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_clientes_crescentes                   | meses_analise integer DEFAULT 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(cliente_id uuid, nome character varying, valor_anterior numeric, valor_atual numeric, percentual_crescimento numeric, total_vendas integer)                                                                                                                                                                                                                                                                                                                                                                             |
| public             | get_clientes_inadimplentes                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(cliente_id uuid, nome character varying, parcelas_atrasadas integer, dias_atraso integer, valor_em_atraso numeric, telefone character varying)                                                                                                                                                                                                                                                                                                                                                                          |
| public             | get_clientes_inativos                     | dias_sem_compra integer DEFAULT 60                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | TABLE(cliente_id uuid, nome character varying, ultima_compra timestamp without time zone, dias_inativo integer, ticket_medio numeric, total_compras_historico integer)                                                                                                                                                                                                                                                                                                                                                        |
| public             | get_clientes_kpis                         | p_search_term text, p_status text, p_loja_ids uuid[], p_compras_min integer, p_compras_max integer, p_valor_min numeric, p_valor_max numeric, p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | TABLE(total_clientes bigint, clientes_ativos bigint, clientes_novos bigint, total_compras bigint, valor_total numeric, ticket_medio numeric)                                                                                                                                                                                                                                                                                                                                                                                  |
| public             | get_clientes_lista                        | p_search_term text, p_status text, p_loja_ids uuid[], p_compras_min integer, p_compras_max integer, p_valor_min numeric, p_valor_max numeric, p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone, p_limit integer, p_offset integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | TABLE(id uuid, nome text, email text, cpf text, telefone text, status text, total_vendas bigint, valor_total_compras numeric, ultima_compra date, created_at timestamp with time zone, total_count bigint)                                                                                                                                                                                                                                                                                                                    |
| public             | get_configuracoes_loja                    | loja_id_param uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | TABLE(loja_id uuid, nome character varying, cnpj character varying, endereco text, telefone character varying, email character varying, logo_url text, configuracoes jsonb)                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_customer_segmentation                 | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(name text, value bigint, avg_ticket numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public             | get_deep_insights_v2                      | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(id text, type text, category text, title text, description text, impact text, score numeric, metadata jsonb)                                                                                                                                                                                                                                                                                                                                                                                                            |
| public             | get_estatisticas_sistema                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(total_clientes integer, total_vendas integer, total_produtos integer, total_usuarios integer, tamanho_banco_mb numeric, uptime_dias integer)                                                                                                                                                                                                                                                                                                                                                                            |
| public             | get_funil_vendas                          | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_heatmap_vendas                        | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(dia_semana integer, hora integer, quantidade_vendas integer, valor_total numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | get_horarios_disponiveis                  | p_loja_id uuid, p_data date, p_duracao_minutos integer DEFAULT 30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(horario timestamp with time zone, disponivel boolean, agendamentos_count integer)                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | get_insights_metrics                      | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(oportunidades numeric, alertas_criticos bigint, precisao_ia numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public             | get_logs_auditoria                        | limite integer DEFAULT 50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | TABLE(log_id uuid, acao character varying, tabela character varying, usuario_email character varying, data_acao timestamp without time zone, detalhes text)                                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_marketing_performance                 | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(canal character varying, categoria character varying, novos_clientes bigint, total_vendas bigint, receita_total numeric, ticket_medio numeric)                                                                                                                                                                                                                                                                                                                                                                          |
| public             | get_metricas_avancadas                    | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(taxa_conversao numeric, tempo_medio_fechamento_dias numeric, total_orcamentos integer, total_vendas_convertidas integer)                                                                                                                                                                                                                                                                                                                                                                                                |
| public             | get_padrao_vendas_por_dia                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(dia_semana character varying, total_vendas integer, valor_medio numeric, percentual_acima_media numeric)                                                                                                                                                                                                                                                                                                                                                                                                                |
| public             | get_perfil_usuario                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(usuario_id uuid, email character varying, nome character varying, role character varying, loja_id uuid, loja_nome character varying, ultimo_acesso timestamp without time zone)                                                                                                                                                                                                                                                                                                                                         |
| public             | get_pos_vendas_lista                      | p_search_term text DEFAULT NULL::text, p_loja_id uuid DEFAULT NULL::uuid, p_status status_pos_venda_type[] DEFAULT NULL::status_pos_venda_type[], p_data_inicio timestamp with time zone DEFAULT NULL::timestamp with time zone, p_data_fim timestamp with time zone DEFAULT NULL::timestamp with time zone, p_limit integer DEFAULT 50, p_offset integer DEFAULT 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | TABLE(id uuid, numero_venda character varying, loja_id uuid, loja_nome character varying, cliente_id uuid, cliente_nome character varying, status_pos_venda status_pos_venda_type, data_confirmacao timestamp without time zone, data_inicio_producao timestamp without time zone, data_produto_pronto timestamp without time zone, data_entrega timestamp without time zone, valor_total numeric, valor_entrada numeric, created_at timestamp without time zone, updated_at timestamp without time zone, total_count bigint) |
| public             | get_previsao_receita                      | meses_historico integer DEFAULT 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(receita_media_mensal numeric, tendencia_crescimento numeric, percentual_crescimento numeric, previsao_proximo_trimestre numeric)                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | get_product_performance                   | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(produto_id uuid, name text, sales bigint, margin numeric, category text)                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public             | get_ranking_prescritores                  | p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(medico text, total_receitas bigint, receitas_convertidas bigint, taxa_conversao numeric, maior_grau_atendido numeric)                                                                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_ranking_vendedores                    | p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(vendedor_id uuid, nome text, avatar text, total_vendas bigint, faturamento numeric, ticket_medio numeric, pecas_vendidas bigint)                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | get_ranking_vendedores_teste              | p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(vendedor_id uuid, nome text, avatar text, total_vendas bigint, faturamento numeric, ticket_medio numeric, pecas_vendidas bigint)                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | get_receita_diaria                        | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_receita_mensal                        | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_receita_por_dia                       | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(data date, receita numeric, vendas integer, ticket_medio numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | get_relatorio_clientes                    | status_filtro character varying DEFAULT NULL::character varying, loja_id_filtro uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | TABLE(cliente_id uuid, nome character varying, cpf_cnpj character varying, email character varying, celular character varying, endereco_completo text, status character varying, data_cadastro date, ultima_compra date, total_compras integer, valor_total_gasto numeric, ticket_medio numeric, saldo_devedor numeric)                                                                                                                                                                                                       |
| public             | get_relatorio_comissoes                   | data_inicio date, data_fim date, vendedor_id_filtro uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(vendedor_id uuid, vendedor_nome character varying, total_vendas integer, valor_total_vendido numeric, ticket_medio numeric, comissao_estimada numeric)                                                                                                                                                                                                                                                                                                                                                                  |
| public             | get_relatorio_financeiro                  | data_inicio date, data_fim date, loja_id_filtro uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | TABLE(receita_total numeric, receita_entrada numeric, receita_prazo numeric, recebimentos_carne numeric, saldo_a_receber numeric, total_vendas integer, ticket_medio numeric, formas_pagamento jsonb)                                                                                                                                                                                                                                                                                                                         |
| public             | get_relatorio_inadimplencia               | loja_id_filtro uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | TABLE(cliente_id uuid, cliente_nome character varying, cliente_cpf_cnpj character varying, cliente_celular character varying, total_parcelas_atrasadas integer, valor_total_atrasado numeric, dias_atraso_maximo integer, vencimento_mais_antigo date)                                                                                                                                                                                                                                                                        |
| public             | get_relatorio_produtos                    | data_inicio date, data_fim date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(tipo_produto character varying, descricao character varying, marca character varying, quantidade_vendida integer, valor_total_vendido numeric, preco_medio numeric, ultima_venda date)                                                                                                                                                                                                                                                                                                                                  |
| public             | get_relatorio_vendas                      | data_inicio date, data_fim date, cliente_id_filtro uuid DEFAULT NULL::uuid, loja_id_filtro uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | TABLE(venda_id uuid, numero_venda character varying, data_venda date, cliente_nome character varying, cliente_cpf_cnpj character varying, loja_nome character varying, vendedor_nome character varying, valor_total numeric, valor_entrada numeric, valor_restante numeric, status character varying, observacoes text, qtd_itens integer)                                                                                                                                                                                    |
| public             | get_resumo_caixa                          | data_ref date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | TABLE(loja_id uuid, loja_nome text, sessao_id uuid, valor_inicial numeric, data_abertura timestamp with time zone, caixa_aberto boolean, total_vendas bigint, valor_total_vendas numeric, valor_entradas numeric, valor_restante numeric, valor_suprimentos numeric, valor_sangrias numeric, saldo_atual numeric, atualizado_em timestamp with time zone)                                                                                                                                                                     |
| public             | get_sales_forecast_data                   | p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(date date, sales numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public             | get_sales_heatmap                         | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_top_clientes                          | p_limite integer DEFAULT 10, p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | TABLE(cliente_id uuid, nome character varying, total_compras integer, valor_total numeric, ticket_medio numeric, ultima_compra date)                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | get_top_produtos                          | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid, p_limit integer DEFAULT 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_user_lojas                            | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(loja_id uuid, loja_nome character varying, loja_codigo character varying, is_primary boolean, can_manage boolean)                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | get_user_permissions                      | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(permission_code text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public             | get_user_profile                          | user_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | get_user_profile                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(id uuid, nome text, email text, avatar_url text, role_code text)                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | get_vendas_categoria                      | p_data_inicio text, p_data_fim text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | get_vendas_kpis                           | p_search_term text DEFAULT NULL::text, p_loja_id uuid DEFAULT NULL::uuid, p_valor_min numeric DEFAULT NULL::numeric, p_valor_max numeric DEFAULT NULL::numeric, p_itens_min integer DEFAULT NULL::integer, p_itens_max integer DEFAULT NULL::integer, p_data_inicio timestamp with time zone DEFAULT NULL::timestamp with time zone, p_data_fim timestamp with time zone DEFAULT NULL::timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(total_vendas bigint, valor_total numeric, ticket_medio numeric, total_itens bigint)                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public             | get_vendas_lista                          | p_search_term text, p_loja_id uuid, p_valor_min numeric, p_valor_max numeric, p_itens_min integer, p_itens_max integer, p_data_inicio timestamp with time zone, p_data_fim timestamp with time zone, p_limit integer, p_offset integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | TABLE(id uuid, numero_venda text, data_venda date, valor_total numeric, valor_entrada numeric, valor_restante numeric, status text, cancelado boolean, nome_cliente_temp text, cliente_nome text, loja_nome text, total_itens bigint, total_count bigint)                                                                                                                                                                                                                                                                     |
| public             | get_vendas_por_categoria                  | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(categoria character varying, quantidade integer, valor_total numeric, percentual numeric)                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public             | get_vendas_por_hora                       | p_data_inicio timestamp with time zone DEFAULT (CURRENT_DATE - '30 days'::interval), p_data_fim timestamp with time zone DEFAULT CURRENT_DATE, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TABLE(hora integer, total_vendas integer, valor_medio numeric)                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public             | gin_btree_consistent                      | internal, smallint, anyelement, integer, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_anyenum                | anyenum, anyenum, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_bit                    | bit, bit, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_bool                   | boolean, boolean, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_bpchar                 | character, character, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_bytea                  | bytea, bytea, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_char                   | "char", "char", smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_cidr                   | cidr, cidr, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_date                   | date, date, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_float4                 | real, real, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_float8                 | double precision, double precision, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_inet                   | inet, inet, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_int2                   | smallint, smallint, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_int4                   | integer, integer, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_int8                   | bigint, bigint, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_interval               | interval, interval, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_macaddr                | macaddr, macaddr, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_macaddr8               | macaddr8, macaddr8, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_money                  | money, money, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_name                   | name, name, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_numeric                | numeric, numeric, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_oid                    | oid, oid, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_text                   | text, text, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_time                   | time without time zone, time without time zone, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_timestamp              | timestamp without time zone, timestamp without time zone, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_timestamptz            | timestamp with time zone, timestamp with time zone, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_timetz                 | time with time zone, time with time zone, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_uuid                   | uuid, uuid, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_compare_prefix_varbit                 | bit varying, bit varying, smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_enum_cmp                              | anyenum, anyenum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_extract_query_anyenum                 | anyenum, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_bit                     | bit, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_bool                    | boolean, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_bpchar                  | character, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_bytea                   | bytea, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_char                    | "char", internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_cidr                    | cidr, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_date                    | date, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_float4                  | real, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_float8                  | double precision, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_inet                    | inet, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_int2                    | smallint, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_int4                    | integer, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_int8                    | bigint, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_interval                | interval, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_macaddr                 | macaddr, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_macaddr8                | macaddr8, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_money                   | money, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_name                    | name, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_numeric                 | numeric, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_oid                     | oid, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_text                    | text, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_time                    | time without time zone, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_timestamp               | timestamp without time zone, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_timestamptz             | timestamp with time zone, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_timetz                  | time with time zone, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_trgm                    | text, internal, smallint, internal, internal, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_uuid                    | uuid, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_query_varbit                  | bit varying, internal, smallint, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_anyenum                 | anyenum, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_bit                     | bit, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_bool                    | boolean, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_bpchar                  | character, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_bytea                   | bytea, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_char                    | "char", internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_cidr                    | cidr, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_date                    | date, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_float4                  | real, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_float8                  | double precision, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_inet                    | inet, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_int2                    | smallint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_int4                    | integer, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_int8                    | bigint, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_interval                | interval, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_macaddr                 | macaddr, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_macaddr8                | macaddr8, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_money                   | money, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_name                    | name, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_numeric                 | numeric, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_oid                     | oid, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_text                    | text, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_time                    | time without time zone, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_timestamp               | timestamp without time zone, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_timestamptz             | timestamp with time zone, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_timetz                  | time with time zone, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_trgm                    | text, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_uuid                    | uuid, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_extract_value_varbit                  | bit varying, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gin_numeric_cmp                           | numeric, numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_trgm_consistent                       | internal, smallint, text, integer, internal, internal, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gin_trgm_triconsistent                    | internal, smallint, text, integer, internal, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | "char"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | gtrgm_compress                            | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gtrgm_consistent                          | internal, text, smallint, oid, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gtrgm_decompress                          | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gtrgm_distance                            | internal, text, smallint, oid, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | double precision                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public             | gtrgm_in                                  | cstring                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | gtrgm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | gtrgm_options                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | gtrgm_out                                 | gtrgm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | cstring                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | gtrgm_penalty                             | internal, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gtrgm_picksplit                           | internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gtrgm_same                                | gtrgm, gtrgm, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | gtrgm_union                               | internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | gtrgm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | incrementar_uso_prompt                    | prompt_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | inserir_profissional_simples              | p_nome character varying, p_tipo character varying, p_cpf character varying DEFAULT NULL::character varying, p_crm character varying DEFAULT NULL::character varying, p_crm_uf character varying DEFAULT NULL::character varying, p_cro character varying DEFAULT NULL::character varying, p_cro_uf character varying DEFAULT NULL::character varying, p_telefone character varying DEFAULT NULL::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | insert_venda_from_view                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | leads_insert_trigger                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | leads_update_trigger                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | listar_lojas_completo                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(id uuid, nome text, codigo text, ativo boolean, responsavel_nome text, responsavel_id uuid, total_colaboradores integer, total_vendas bigint, faturamento_total numeric, meta_mensal numeric, ultima_venda_data date, criado_em timestamp without time zone)                                                                                                                                                                                                                                                            |
| public             | listar_profissionais_saude                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(id uuid, nome text, tipo_profissional text, tipo_profissional_formatado text, registro_formatado text, especialidades text[], email text, telefone text, celular text, registro_vigente boolean, registro_valido_ate date, e_responsavel_tecnico boolean, qtd_lojas_responsavel integer, loja_nome text, loja_codigo text, status text, status_formatado text, criado_em timestamp without time zone, origem text)                                                                                                      |
| public             | listar_receitas_cliente                   | p_cliente_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | listar_todas_pessoas                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(id uuid, nome_completo text, email text, telefone text, cargo_nome text, cargo_nivel integer, role_name text, role_code text, loja_nome text, loja_codigo text, status text, status_formatado text, alerta_seguranca text, ultimo_acesso timestamp without time zone, criado_em timestamp without time zone, origem text)                                                                                                                                                                                               |
| public             | logout_user_session                       | session_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | map_cargo_to_role                         | p_cargo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | normalizar_telefone                       | telefone text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | normalizar_texto                          | texto text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | obter_detalhes_loja                       | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | obter_detalhes_profissional               | p_id uuid, p_origem text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | obter_estatisticas_admin                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | obter_fechamento_caixa                    | p_sessao_id uuid, p_loja_id uuid, p_data date DEFAULT CURRENT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | obter_limites_desconto_usuario            | p_usuario_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | TABLE(limite_desconto_percentual numeric, requer_autorizacao_acima numeric, pode_autorizar_outros boolean, role_name character varying, vendedor_id uuid)                                                                                                                                                                                                                                                                                                                                                                     |
| public             | obter_ranking_vendas                      | p_limit integer DEFAULT 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | TABLE(posicao bigint, vendedor_id uuid, user_id uuid, vendedor_nome text, total_vendas bigint, valor_total numeric, nivel text)                                                                                                                                                                                                                                                                                                                                                                                               |
| public             | obter_responsavel_otico_loja              | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(id uuid, profissional_nome character varying, tipo_profissional character varying, registro_principal text, telefone character varying, celular character varying, email character varying, alvara_numero character varying, alvara_valido_ate date, status_compliance text)                                                                                                                                                                                                                                            |
| public             | prever_churn                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(cliente_id uuid, cliente_nome character varying, ultima_compra date, dias_sem_comprar integer, total_compras bigint, risco_churn character varying, acao_recomendada text)                                                                                                                                                                                                                                                                                                                                              |
| public             | prompts_ia_insert                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | proximo_numero_orcamento                  | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | proximo_numero_venda                      | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | recalcular_status_carne_manual            | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | register_user_session                     | user_uuid uuid, p_ip_address inet, p_user_agent text, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | registrar_conversao_orcamento             | p_orcamento_id uuid, p_grupo_selecionado character varying, p_forma_pagamento_id uuid, p_valor_entrada numeric DEFAULT 0, p_numero_parcelas integer DEFAULT 1, p_canal_aquisicao_id uuid DEFAULT NULL::uuid, p_observacoes_marketing text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | registrar_pagamento_adicional             | p_venda_id uuid, p_forma_pagamento_id uuid, p_valor numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | registrar_pagamento_entrada_carne         | p_venda_id uuid, p_forma_pagamento_id uuid, p_valor numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | registrar_pagamento_parcelado             | p_venda_id uuid, p_forma_pagamento_id uuid, p_numero_parcelas integer, p_valor_saldo numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | relatorio_vendas_consolidado              | p_data_inicio date, p_data_fim date, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | TABLE(loja_codigo character varying, loja_nome character varying, periodo_inicio date, periodo_fim date, total_vendas bigint, valor_bruto numeric, valor_descontos numeric, valor_liquido numeric, valor_entrada numeric, valor_restante numeric, valor_recebido numeric, ticket_medio numeric, clientes_unicos bigint, vendas_por_dia numeric, maior_venda numeric, menor_venda numeric)                                                                                                                                     |
| public             | renovar_registro_profissional             | p_id uuid, p_nova_validade date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | rpc_simular_carne                         | p_valor_principal numeric, p_numero_parcelas integer, p_data_primeira_parcela date DEFAULT NULL::date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TABLE(parcela_numero integer, data_vencimento date, valor_parcela numeric, valor_juros numeric, valor_amortizacao numeric, saldo_devedor numeric, sistema_amortizacao text, taxa_mensal numeric)                                                                                                                                                                                                                                                                                                                              |
| public             | set_limit                                 | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | show_limit                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | show_trgm                                 | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public             | similarity                                | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | similarity_dist                           | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | similarity_op                             | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | strict_word_similarity                    | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | strict_word_similarity_commutator_op      | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | strict_word_similarity_dist_commutator_op | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | strict_word_similarity_dist_op            | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | strict_word_similarity_op                 | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | sugestoes_campanha_insert                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | sync_user_on_signup                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | tendencias_insert                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | tendencias_update                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | transferir_colaborador_loja               | p_id uuid, p_nova_loja_id uuid, p_origem text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | unaccent                                  | regdictionary, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | unaccent                                  | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | unaccent_init                             | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | unaccent_lexize                           | internal, internal, internal, internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | internal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | update_configuracoes_loja                 | loja_id_param uuid, config_data jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | update_updated_at_column                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | update_user_last_activity                 | session_uuid uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | validar_cpf                               | cpf text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | validar_desconto_usuario                  | p_cargo_id uuid, p_tipo_desconto character varying, p_valor_desconto numeric, p_valor_original numeric, p_tipo_produto character varying DEFAULT 'GERAL'::character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | validar_entrega_venda                     | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | validar_telefone_br                       | telefone text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | validar_venda                             | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | verificar_acesso_admin                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(has_access boolean, reason text, user_role text, user_status text)                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public             | verificar_caixa_aberto                    | p_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | vincular_profissional_venda               | p_venda_id uuid, p_profissional_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | vincular_vendedor_usuario_manual          | p_vendedor_id uuid, p_email_usuario text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public             | word_similarity                           | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | word_similarity_commutator_op             | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public             | word_similarity_dist_commutator_op        | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | word_similarity_dist_op                   | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | real                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public             | word_similarity_op                        | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime           | apply_rls                                 | wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | SETOF realtime.wal_rls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| realtime           | broadcast_changes                         | topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime           | build_prepared_statement_sql              | prepared_statement_name text, entity regclass, columns realtime.wal_column[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime           | cast                                      | val text, type_ regtype                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| realtime           | check_equality_op                         | op realtime.equality_op, type_ regtype, val_1 text, val_2 text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime           | is_visible_through_filters                | columns realtime.wal_column[], filters realtime.user_defined_filter[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime           | list_changes                              | publication name, slot_name name, max_changes integer, max_record_bytes integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | SETOF realtime.wal_rls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| realtime           | quote_wal2json                            | entity regclass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime           | send                                      | payload jsonb, event text, topic text, private boolean DEFAULT true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime           | subscription_check_filters                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime           | to_regrole                                | role_name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | regrole                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime           | topic                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | add_prefixes                              | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | can_insert_object                         | bucketid text, name text, owner uuid, metadata jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | delete_leaf_prefixes                      | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | delete_prefix                             | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | delete_prefix_hierarchy_trigger           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | enforce_bucket_name_length                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | extension                                 | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | filename                                  | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | foldername                                | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage            | get_level                                 | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | get_prefix                                | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | get_prefixes                              | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage            | get_size_by_bucket                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(size bigint, bucket_id text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| storage            | list_multipart_uploads_with_delimiter     | bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | TABLE(key text, id text, created_at timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| storage            | list_objects_with_delimiter               | bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| storage            | lock_top_prefixes                         | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | objects_delete_cleanup                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | objects_insert_prefix_trigger             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | objects_update_cleanup                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | objects_update_level_trigger              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | objects_update_prefix_trigger             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | operation                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage            | prefixes_delete_cleanup                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | prefixes_insert_trigger                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage            | search                                    | prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)                                                                                                                                                                                                                                                                                                                                                                |
| storage            | search_legacy_v1                          | prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)                                                                                                                                                                                                                                                                                                                                                                |
| storage            | search_v1_optimised                       | prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)                                                                                                                                                                                                                                                                                                                                                                |
| storage            | search_v2                                 | prefix text, bucket_name text, limits integer DEFAULT 100, levels integer DEFAULT 1, start_after text DEFAULT ''::text, sort_order text DEFAULT 'asc'::text, sort_column text DEFAULT 'name'::text, sort_column_after text DEFAULT ''::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)                                                                                                                                                                                                                                                                                                                                                      |
| storage            | update_updated_at_column                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| supabase_functions | http_request                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vault              | _crypto_aead_det_decrypt                  | message bytea, additional bytea, key_id bigint, context bytea DEFAULT '\x7067736f6469756d'::bytea, nonce bytea DEFAULT NULL::bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vault              | _crypto_aead_det_encrypt                  | message bytea, additional bytea, key_id bigint, context bytea DEFAULT '\x7067736f6469756d'::bytea, nonce bytea DEFAULT NULL::bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vault              | _crypto_aead_det_noncegen                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vault              | create_secret                             | new_secret text, new_name text DEFAULT NULL::text, new_description text DEFAULT ''::text, new_key_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vault              | update_secret                             | secret_id uuid, new_secret text DEFAULT NULL::text, new_name text DEFAULT NULL::text, new_description text DEFAULT NULL::text, new_key_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vendas             | atualizar_lead_status_orcamento           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | atualizar_orcamento_timestamp             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | atualizar_parcelas_atrasadas              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vendas             | atualizar_status_entrada                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | atualizar_status_financeiro               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | atualizar_status_parcelas_vencidas        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(parcela_id uuid, numero_venda numeric, numero_parcela integer, data_vencimento date, dias_atraso integer, valor_original numeric, valor_com_juros numeric)                                                                                                                                                                                                                                                                                                                                                              |
| vendas             | atualizar_updated_at_entregas_os          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | atualizar_updated_at_restituicoes         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | calcular_data_limite_entrada              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | calcular_juros_atraso                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | calcular_resumo_caixa                     | p_sessao_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | calcular_total_vendas_periodo             | data_inicio date, data_fim date, p_loja_id uuid DEFAULT NULL::uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | TABLE(loja_codigo character varying, total_vendas bigint, valor_total numeric, valor_entrada numeric, valor_restante numeric)                                                                                                                                                                                                                                                                                                                                                                                                 |
| vendas             | calcular_valor_pago                       | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | converter_venda_para_carne                | p_venda_id uuid, p_numero_parcelas integer, p_formas_pagamento_entrada text DEFAULT NULL::text, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | criar_lead_orcamento                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | fn_calcular_grau_perto                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | fn_detectar_tipo_visao                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | fn_validar_formas_pagamento               | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | gerar_numero_orcamento                    | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vendas             | inicializar_contadores_existentes         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(loja_nome character varying, ultimo_numero integer, total integer)                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| vendas             | obter_responsavel_otico_ativo             | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TABLE(id uuid, nome_profissional character varying, tipo_profissional character varying, crm character varying, cro character varying, data_inicio date, numero_alvara character varying, alvara_valido_ate date)                                                                                                                                                                                                                                                                                                             |
| vendas             | proximo_numero_venda                      | p_loja_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | recalcular_status_carne                   | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | status_carne_type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vendas             | registrar_entrega_brinde                  | p_venda_id uuid, p_sku_visual text, p_quantidade integer DEFAULT 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vendas             | registrar_historico_entrada               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | registrar_pagamento_adicional             | p_venda_id uuid, p_forma_pagamento_id uuid, p_valor numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | registrar_pagamento_entrada_carne         | p_venda_id uuid, p_forma_pagamento_id uuid, p_valor numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | registrar_pagamento_parcelado             | p_venda_id uuid, p_forma_pagamento_id uuid, p_numero_parcelas integer, p_valor_saldo numeric, p_observacao text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | resetar_contador_venda                    | p_loja_id uuid, p_novo_numero integer DEFAULT 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vendas             | revisar_autorizacao                       | p_autorizacao_id uuid, p_gerente_id uuid, p_status text, p_motivo text DEFAULT NULL::text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | solicitar_autorizacao_desconto            | p_loja_id uuid, p_vendedor_id uuid, p_cliente_id uuid, p_valor_original numeric, p_percentual_desconto numeric, p_justificativa text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | trigger_atualizar_timestamp               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | trigger_recalcular_status_carne           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | trigger_registrar_historico_status        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | validar_entrega_venda                     | p_venda_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | validar_parcelas_recebidas                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(venda_id uuid, numero_venda character varying, parcelas_recebidas bigint, parcelas_esperadas integer, diferenca integer)                                                                                                                                                                                                                                                                                                                                                                                                |
| vendas             | validar_profissional_venda                | p_venda_id uuid, p_profissional_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vendas             | validar_registro_profissional_vigente     | p_profissional_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vendas             | validar_transicao_status_pos_venda        | p_status_atual status_pos_venda_type, p_status_novo status_pos_venda_type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

-- ============================================================================
-- ETAPA 9: INVESTIGAÇÃO ESPECÍFICA - ARMAÇÕES NO PDV
-- ============================================================================
-- (Ajustar schema e tabela conforme descoberto nas ETAPAs anteriores)

-- Primeiro, verificar campos de tipo/categoria na tabela de produtos
SELECT 
    table_schema,
    table_name,
    column_name as coluna,
    data_type as tipo
FROM information_schema.columns
WHERE table_name ILIKE '%produto%'
AND (column_name ILIKE '%tipo%' 
     OR column_name ILIKE '%categoria%'
     OR column_name ILIKE '%classificacao%')
ORDER BY table_schema, table_name, ordinal_position;
| table_schema | table_name                | coluna       | tipo              |
| ------------ | ------------------------- | ------------ | ----------------- |
| public       | vw_produtos_mais_vendidos | tipo_produto | character varying |


-- Verificar estrutura de preços (ajustar schema.tabela)
SELECT 
    table_schema,
    table_name,
    column_name as coluna,
    data_type as tipo
FROM information_schema.columns
WHERE table_name ILIKE '%produto%'
AND column_name ILIKE '%preco%'
ORDER BY table_schema, table_name, ordinal_position;
| table_schema | table_name                | coluna      | tipo    |
| ------------ | ------------------------- | ----------- | ------- |
| public       | vw_produtos_mais_vendidos | preco_medio | numeric |

-- DEPOIS de descobrir schema/tabela/campos corretos, executar contagem:
-- SELECT COUNT(*) as total FROM schema.produtos WHERE campo_tipo = 'armacao';

-- ============================================================================
-- NOTAS PARA PREENCHER APÓS EXECUÇÃO:
-- ============================================================================
-- [ ] Quantos schemas encontrados?
-- [ ] Qual o schema principal do PDV?
-- [ ] Nome correto da tabela de vendas:
-- [ ] Nome correto da tabela de itens de venda:
-- [ ] Nome correto da tabela de produtos:
-- [ ] O PDV já tem armações cadastradas? Quantas?
-- [ ] Como é a estrutura de preços (custo, venda, margem)?
-- [ ] Existem views? Quais?
-- [ ] Existem stored procedures? Quais?
-- [ ] Total de registros em cada tabela principal:
-- [ ] O PDV está integrado com algum outro sistema?
